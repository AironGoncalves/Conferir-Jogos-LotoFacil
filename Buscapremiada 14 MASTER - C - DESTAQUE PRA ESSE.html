<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Painel de Loterias Pro - Vers√£o 3.2</title>
	
    <!-- √çcone do aplicativo - Trevo üçÄ -->
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçÄ</text></svg>">
    
    <!-- Para dispositivos Apple -->
    <link rel="apple-touch-icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üçÄ</text></svg>">
    

    <style>
        :root {
            --cor-lotofacil: #8b008b;
            --cor-megasena: #209869;
            --bg-body: #f0f2f5;
        }
        body {
            font-family: 'Segoe UI', sans-serif;
            background-color: var(--bg-body);
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
        }
        #modalCustom {
            display: none;
            position: fixed;
            z-index: 9999;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            background: rgba(0,0,0,0.6);
            align-items: center;
            justify-content: center;
        }
        .modal-content {
            background: white;
            padding: 20px;
            border-radius: 12px;
            text-align: center;
            max-width: 320px;
            width: 90%;
            box-shadow: 0 10px 30px rgba(0,0,0,0.3);
        }
        .modal-btns {
            display: flex;
            gap: 10px;
            justify-content: center;
            margin-top: 20px;
            flex-wrap: wrap;
        }
        .btn-modal {
            padding: 10px 20px;
            border-radius: 6px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            flex: 1;
            min-width: 80px;
        }
        .lf-theme .btn-sim {
            background: var(--cor-lotofacil);
            color: white;
        }
        .ms-theme .btn-sim {
            background: var(--cor-megasena);
            color: white;
        }
        .btn-nao {
            background: #eee;
            color: #333;
        }
        .menu-loterias {
            display: flex;
            gap: 10px;
            margin-bottom: 20px;
            width: 100%;
            max-width: 500px;
        }
        .btn-aba {
            flex: 1;
            padding: 15px;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            font-weight: bold;
            font-size: 14px;
            color: white;
            transition: 0.3s;
            opacity: 0.6;
            text-transform: uppercase;
        }
        .btn-aba.active {
            opacity: 1;
            transform: scale(1.05);
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }
        .aba-lotofacil {
            background-color: var(--cor-lotofacil);
        }
        .aba-megasena {
            background-color: var(--cor-megasena);
        }
        .container {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            max-width: 500px;
            width: 100%;
            display: none;
        }
        .container.active {
            display: block;
        }
        h2 {
            text-align: center;
            margin-bottom: 5px;
        }
        .busca-concurso {
            display: flex;
            gap: 5px;
            margin-bottom: 15px;
            justify-content: center;
            align-items: center;
        }
        .busca-concurso input {
            width: 100px;
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 5px;
            text-align: center;
            font-size: 16px;
            font-weight: bold;
        }
        .btn-nav {
            color: white;
            border: none;
            border-radius: 5px;
            width: 35px;
            height: 38px;
            cursor: pointer;
            font-weight: bold;
            font-size: 20px;
        }
        .btn-busca {
            background: #666;
            color: white;
            padding: 5px 15px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            height: 38px;
        }
        .concurso-info {
            text-align: center;
            font-size: 0.95em;
            color: #333;
            font-weight: bold;
            margin-bottom: 10px;
            min-height: 20px;
        }
        .bolas-container {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
            justify-content: center;
            padding: 10px;
            border-radius: 8px;
            margin-bottom: 10px;
        }
        .bola {
            width: 32px;
            height: 32px;
            color: white;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
            font-weight: bold;
        }
        .lf-theme .bola {
            background: var(--cor-lotofacil);
        }
        .lf-theme .bolas-container {
            background: #f8f0f8;
        }
        .ms-theme .bola {
            background: var(--cor-megasena);
        }
        .ms-theme .bolas-container {
            background: #f0f8f4;
        }
        .resumo-geral {
            border-radius: 8px;
            padding: 12px;
            margin-bottom: 20px;
            font-size: 0.9em;
            text-align: center;
            line-height: 1.6;
        }
.lf-theme .resumo-geral {
            background: #eef2ff;
            border: 1px solid #c7d2fe;
            color: #3730a3;
        }
        .ms-theme .resumo-geral {
            background: #e6fffa;
            border: 1px solid #b2f5ea;
            color: #234e52;
        }
        .caixa-acerto {
            background: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(0, 0, 0, 0.03);
            border-radius: 6px;
            padding: 4px 12px;
            display: inline-block;
            margin: 4px 2px;
        }
        .add-jogo-section {
            background: #eee;
            padding: 15px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        .add-jogo-section input {
            width: 100%;
            padding: 10px;
            border: 2px solid #ddd;
            border-radius: 5px;
            box-sizing: border-box;
            font-size: 16px;
        }
        .btn {
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            padding: 10px;
            transition: 0.3s;
            width: 100%;
        }
        .btn-add-lf {
            background: var(--cor-lotofacil);
            color: white;
        }
        .btn-add-ms {
            background: var(--cor-megasena);
            color: white;
        }
        .btn-random {
            background: #555;
            color: white;
            font-size: 0.85em;
            margin-top: 5px;
        }
        .btn-limpar {
            background: #ff4444;
            color: white;
            margin-top: 10px;
            opacity: 0.7;
        }
        .secao-memoria {
            background: #f9f9f9;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 10px;
            margin-bottom: 15px;
        }
        .grid-memoria {
            display: grid;
            grid-template-columns: repeat(5, 1fr);
            gap: 5px;
            margin-top: 10px;
        }
        .btn-memoria {
            padding: 8px 2px;
            font-size: 11px;
            background: #fff;
            border: 1px solid #ccc;
            border-radius: 4px;
            cursor: pointer;
            font-weight: bold;
            transition: 0.3s;
        }
        .btn-memoria:hover {
            background: #eee;
        }
        .btn-memoria.slot-active {
            background: #444;
            color: #fff;
            border-color: #000;
            transform: scale(1.05);
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
 	.btn-memoria.slot-vazio {
            background: #f0f0f0;
            color: #888;
            border-color: #ddd;
            font-style: italic;
        }
        .btn-guardar {
            width: 100%;
            font-size: 12px;
            padding: 8px;
            background: #444;
            color: white;
            border-radius: 5px;
            border: none;
            cursor: pointer;
        }
        .badge-vitorias {
            background: #ffd700;
            color: #000;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: 5px;
            border: 1px solid #daa520;
            font-weight: 900;
        }
        .badge-doze {
            background: #00c3ff;
            color: #fff;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: 5px;
            border: 1px solid #0096c7;
            font-weight: 900;
        }
        .badge-treze {
            background: #3730a3;
            color: #fff;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: 5px;
            border: 1px solid #1e1b4b;
            font-weight: 900;
        }
        .badge-dinheiro {
            background: #209869;
            color: #fff;
            font-size: 10px;
            padding: 2px 8px;
            border-radius: 10px;
            margin-left: 5px;
            font-weight: 900;
        }
        .painel-financeiro {
            margin-top: 15px;
            padding: 15px;
            border-radius: 10px;
            background: #fff;
            border: 1px solid #ddd;
        }
        .financeiro-item {
            display: flex;
            justify-content: space-between;
            margin-bottom: 5px;
            font-size: 14px;
        }
        .financeiro-total {
            border-top: 1px solid #eee;
            margin-top: 10px;
            padding-top: 10px;
            font-weight: bold;
            font-size: 16px;
        }
        .lucro {
            color: #209869;
        }
        .prejuizo {
            color: #d93025;
        }
        .contagem-especial {
            margin-top: 10px;
            padding: 12px;
            background: #fffde7;
            border: 1px solid #fbc02d;
            border-radius: 10px;
            font-size: 14px;
            color: #5d4037;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .aviso-legal {
            margin-top: 15px;
            font-size: 11px;
            color: #777;
            text-align: center;
            line-height: 1.4;
            padding: 10px;
            border-top: 1px dashed #ccc;
        }
        .card-jogo {
            background: #fff;
            border: 1px solid #ddd;
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 10px;
            position: relative;
        }
        .premiado {
            background-color: #d4edda !important;
            border: 2px solid #28a745 !important;
        }
        .remove-btn {
            position: absolute;
            top: 5px;
            right: 5px;
            color: #999;
            cursor: pointer;
            border: none;
            background: none;
            font-weight: bold;
        }
        .num-acertado-lf {
            color: var(--cor-lotofacil);
            font-weight: bold;
            background: #fdf0fd;
            border-bottom: 2px solid var(--cor-lotofacil);
        }
        .num-acertado-ms {
            color: var(--cor-megasena);
            font-weight: bold;
            background: #f0fdf4;
            border-bottom: 2px solid var(--cor-megasena);
        }
        .progress-container {
            width: 100%;
            background-color: #ddd;
            border-radius: 10px;
            margin-top: 8px;
            display: none;
            height: 10px;
            overflow: hidden;
        }
        .progress-bar {
            height: 100%;
            background-color: #f39c12;
            width: 0%;
            transition: width 0.1s;
        }
        .aviso-link {
            color: #0e9f6e;
            text-decoration: none;
            font-weight: bold;
        }
        .aviso-link:hover {
            text-decoration: underline;
        }
        .aviso-link {font-size: 13px; }
        
        /* Estilo para o novo bot√£o de alta performance */
        .btn-high-performance {
            background: linear-gradient(45deg, #ff6b6b, #ee5a24);
            color: white;
            font-size: 0.85em;
            margin-top: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            padding: 10px;
            transition: 0.3s;
            width: 100%;
        }
        .btn-high-performance:hover {
            background: linear-gradient(45deg, #ee5a24, #ff6b6b);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        /* Estilo para o bot√£o de transfer√™ncia */
        .btn-transferir {
            background: linear-gradient(45deg, #209869, #1e824c);
            color: white;
            font-size: 0.85em;
            margin-top: 5px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-weight: bold;
            padding: 10px;
            transition: 0.3s;
            width: 100%;
        }
        .btn-transferir:hover {
            background: linear-gradient(45deg, #1e824c, #209869);
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }
        
        /* Modal do Scanner - Responsivo */
    #modalScanner {
        display: none;
        position: fixed;
        z-index: 10000;
        left: 0;
        top: 0;
        width: 100%;
        height: 100%;
        background: rgba(0,0,0,0.8);
        align-items: center;
        justify-content: center;
        overflow: auto;
        padding: 10px;
    }
    
    .modal-scanner-content {
        background: white;
        padding: 20px;
        border-radius: 15px;
        width: 100%;
        max-width: 400px; /* Largura m√°xima para smartphone */
        max-height: 90vh;
        overflow-y: auto;
        box-shadow: 0 15px 40px rgba(0,0,0,0.3);
        margin: auto;
    }
    
    /* Ajustes para telas menores */
    @media (max-width: 480px) {
        .modal-scanner-content {
            padding: 15px;
            max-width: 95%; /* Ocupa 95% da tela em smartphones */
            margin: 10px;
        }
        
        .config-grid {
            grid-template-columns: 1fr !important; /* 1 coluna em mobile */
            gap: 10px !important;
        }
        
        .painel-financeiro {
            grid-template-columns: 1fr !important; /* 1 coluna em mobile */
        }
        
        .fin-box {
            border-right: none !important;
            border-bottom: 1px solid #4a5568;
            padding-bottom: 8px;
            margin-bottom: 8px;
        }
        
        .fin-box:last-child {
            border-bottom: none;
            margin-bottom: 0;
        }
        
        .scanner-header h2 {
            font-size: 18px !important;
        }
        
        .close-scanner {
            padding: 6px 12px !important;
            font-size: 12px !important;
        }
        
        button {
            padding: 12px !important;
            font-size: 14px !important;
        }
        
        input {
            padding: 8px !important;
            font-size: 14px !important;
        }
    }
    
    /* Para tablets */
    @media (min-width: 481px) and (max-width: 768px) {
        .modal-scanner-content {
            max-width: 450px;
        }
        
        .config-grid {
            grid-template-columns: 1fr 1fr !important; /* 2 colunas em tablet */
        }
    }


 /* Estilos responsivos para os jogos gerados no scanner */
    @media (max-width: 480px) {
        .jogo-item-scanner {
            padding: 12px !important;
            margin-bottom: 10px !important;
        }
        
        .dezenas-scanner .bola {
            width: 28px !important;
            height: 28px !important;
            font-size: 12px !important;
        }
        
        .resumo-financeiro-scanner {
            grid-template-columns: 1fr !important;
            gap: 6px !important;
            font-size: 11px !important;
            padding: 10px !important;
        }
        
        .lucro-destaque-scanner {
            grid-column: 1 !important;
            font-size: 13px !important;
        }
    }
    
    /* Ajuste para toast no mobile */
    @media (max-width: 480px) {
        .toast-scanner {
            min-width: 250px !important;
            padding: 12px 20px !important;
            font-size: 13px !important;
        }
        
        .toast-scanner[data-position="center"] {
            width: 90% !important;
            left: 5% !important;
            transform: translateX(0) !important;
        }
    }


/* Modal de Confirma√ß√£o do Scanner */
.modal-scanner-confirm {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.7);
    z-index: 10002;
    align-items: center;
    justify-content: center;
}

.modal-scanner-confirm-content {
    background: white;
    padding: 25px;
    border-radius: 12px;
    max-width: 400px;
    width: 90%;
    box-shadow: 0 10px 30px rgba(0,0,0,0.3);
}

.modal-scanner-buttons {
    display: flex;
    gap: 10px;
    margin-top: 20px;
    justify-content: center;
}

.btn-scanner-modal {
    padding: 12px 20px;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-weight: bold;
    font-size: 14px;
    flex: 1;
    min-width: 120px;
}

.btn-scanner-confirm {
    background: #4CAF50;
    color: white;
}

.btn-scanner-cancel {
    background: #f44336;
    color: white;
}

.btn-scanner-add {
    background: #2196F3;
    color: white;
}



.tooltip-box {
    position: absolute;
    bottom: 100%;
    left: 50%;
    transform: translateX(-50%) translateY(10px);
    background: #2c3e50;
    color: white;
    padding: 12px 20px;
    border-radius: 8px;
    white-space: nowrap;
    opacity: 0;
    transition: all 0.3s ease;
    pointer-events: none;
    z-index: 1000;
    box-shadow: 0 4px 12px rgba(0,0,0,0.15);
    text-align: center;
    min-width: 180px;
}

.tooltip-box:after {
    content: '';
    position: absolute;
    top: 100%;
    left: 50%;
    transform: translateX(-50%);
    border: 6px solid transparent;
    border-top-color: #2c3e50;
}

.tooltip-box.show {
    opacity: 1;
    transform: translateX(-50%) translateY(-5px);
    pointer-events: auto;
}

/* NOVOS ESTILOS PARA AS ATUALIZA√á√ïES */

/* Modal para selecionar n√∫meros */
#modalNumeros {
    display: none;
    position: fixed;
    z-index: 9999;
    left: 0;
    top: 0;
    width: 100%;
    height: 100%;
    background: rgba(0,0,0,0.8);
    align-items: center;
    justify-content: center;
}

.modal-numeros-content {
    background: white;
    padding: 20px;
    border-radius: 15px;
    max-width: 400px;
    width: 90%;
    max-height: 80vh;
    overflow-y: auto;
}

.numeros-grid {
    display: grid;
    grid-template-columns: repeat(5, 1fr);
    gap: 10px;
    margin: 20px 0;
}

.numero-btn {
    width: 45px;
    height: 45px;
    border: 2px solid #ddd;
    border-radius: 50%;
    background: white;
    font-weight: bold;
    font-size: 16px;
    cursor: pointer;
    transition: all 0.3s;
}

.numero-btn:hover {
    transform: scale(1.1);
}

.numero-btn.selecionado {
    background: var(--cor-lotofacil);
    color: white;
    border-color: var(--cor-lotofacil);
}

.contador-selecionados {
    text-align: center;
    font-weight: bold;
    margin: 15px 0;
    color: #333;
}

.btn-confirmar-numeros {
    background: var(--cor-lotofacil);
    color: white;
    border: none;
    border-radius: 8px;
    padding: 12px;
    font-size: 16px;
    font-weight: bold;
    cursor: pointer;
    width: 100%;
    margin-top: 10px;
}

/* Estilo para campo de concurso final no scanner */
.campo-concurso-final {
    grid-column: span 2;
    margin-top: 5px;
}

.campo-concurso-final label {
    font-size: 12px;
    font-weight: bold;
    color: #555;
    display: block;
    margin-bottom: 5px;
}

.campo-concurso-final input {
    width: 100%;
    padding: 10px;
    border: 2px solid #ddd;
    border-radius: 8px;
    font-size: 14px;
    outline: none;
    transition: 0.3s;
    box-sizing: border-box;
}

.campo-concurso-final input:focus {
    border-color: #9b2a92;
}

/* Para slots vazios */
.btn-slot-vazio {
    background: #888 !important;
    color: white;
    opacity: 0.8;
}

.btn-slot-vazio:hover {
    opacity: 1;
}

    </style>
</head>
<body class="lf-theme">
    <div id="modalCustom">
        <div class="modal-content">
            <p id="modalMsg" style="font-weight: bold; color: #333;"></p>
            <div id="modalContainerBotoes" class="modal-btns">
                <button id="btnSim" class="btn-modal btn-sim">Confirmar</button>
                <button id="btnNao" class="btn-modal btn-nao">Cancelar</button>
            </div>
        </div>
    </div>
    
    <!-- Modal para selecionar n√∫meros -->
    <div id="modalNumeros">
        <div class="modal-numeros-content">
            <h3 style="color: var(--cor-lotofacil); text-align: center; margin-bottom: 15px;">Selecione os N√∫meros</h3>
            <div class="contador-selecionados" id="contadorSelecionados">Selecionados: 0/15</div>
            <div class="numeros-grid" id="numerosGrid"></div>
            <div style="text-align: center; margin: 15px 0;">
                <button onclick="limparSelecaoNumeros()" style="background: #ff4444; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; margin-right: 10px;">Limpar</button>
                <button onclick="fecharModalNumeros()" style="background: #666; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer;">Cancelar</button>
            </div>
            <button class="btn-confirmar-numeros" onclick="confirmarSelecaoNumeros()">‚úÖ Confirmar Sele√ß√£o</button>
        </div>
    </div>

    <!-- Modal do Scanner de Alta Performance -->
    <div id="modalScanner">
        <div class="modal-scanner-content" id="scannerContent">
            <!-- O conte√∫do do scanner ser√° injetado aqui -->
        </div>
    </div>

    <div class="menu-loterias">
        <button class="btn-aba aba-lotofacil active" onclick="switchTab('lotofacil')">Lotof√°cil</button>
        <button class="btn-aba aba-megasena" onclick="switchTab('megasena')">Mega-Sena</button>
        <button class="btn-aba" onclick="abrirScannerAltaPerformance()" style="background: linear-gradient(45deg, #ff6b6b, #ee5a24); flex: 1.2;">üöÄ Gerar jogos com Alta Performance</button>
    </div>

    <div id="cont-lotofacil" class="container active lf-theme">
        <h2 style="color:var(--cor-lotofacil)">Lotof√°cil</h2>
        <div class="busca-concurso">
            <button class="btn-nav aba-lotofacil" onclick="navegarConcurso('lotofacil', -1)">-</button>
            <input type="number" id="numLF" placeholder="N¬∫">
            <button class="btn-nav aba-lotofacil" onclick="navegarConcurso('lotofacil', 1)">+</button>
            <button class="btn-busca" onclick="resetarEBuscar('lotofacil', document.getElementById('numLF').value)">Buscar</button>
        </div>
        <p id="infoLF" class="concurso-info">Carregando...</p>
        <div id="bolasLF" class="bolas-container"></div>
        <div id="resumoLF" class="resumo-geral">Aguardando...</div>
        <div class="add-jogo-section">
            <label><b>Cadastrar Jogo:</b></label>
            <div style="display: flex; gap: 5px;">
                <input type="text" id="inputLF" placeholder="Digite de 15 a 20 n√∫meros" style="flex: 1;">
                <button onclick="abrirSelecionadorNumeros('lotofacil')" style="background: var(--cor-lotofacil); color: white; border: none; border-radius: 5px; width: 40px; cursor: pointer; font-weight: bold; font-size: 18px;">üéØ</button>
            </div>
            <button class="btn btn-add-lf" onclick="adicionarJogo('lotofacil')">Salvar Jogo na Lista</button>
            <button class="btn btn-random" onclick="gerarSurpresinha('lotofacil')">üé≤ Gerar Surpresinha (15 n√∫meros)</button>
        </div>
        <div class="secao-memoria">
            <button class="btn-guardar" onclick="prepararSalvamentoSlot('lotofacil')">üíæ Guardar Lista Atual em um Slot</button>
            <div class="grid-memoria">
                <button class="btn-memoria btn-memoria-lf-A" onclick="carregarSlot('lotofacil', 'A')">Jogo A</button>
                <button class="btn-memoria btn-memoria-lf-B" onclick="carregarSlot('lotofacil', 'B')">Jogo B</button>
                <button class="btn-memoria btn-memoria-lf-C" onclick="carregarSlot('lotofacil', 'C')">Jogo C</button>
                <button class="btn-memoria btn-memoria-lf-D" onclick="carregarSlot('lotofacil', 'D')">Jogo D</button>
                <button class="btn-memoria btn-memoria-lf-E" onclick="carregarSlot('lotofacil', 'E')">Jogo E</button>
            </div>
        </div>
        <div id="listaLF"></div>
        <button class="btn btn-limpar" onclick="confirmarLimpar('lotofacil')">Apagar Tudo</button>
        <div class="painel-financeiro" id="finLF">
            <div class="financeiro-item"><span>Total Gasto:</span> <span id="valInvestidoLF">R$ 0,00</span></div>
            <div class="financeiro-item"><span>Total de Ganhos:</span> <span id="valGanhoLF">R$ 0,00</span></div>
            <div class="financeiro-total" id="statusLF">Saldo: R$ 0,00</span></div>
        </div>
        <div id="contagemEspecialLF" class="contagem-especial">
            <strong>üèÜ Pr√™mios de Elite Acumulados:</strong>
            <div id="count14LF">14 Acertos: 0x</div>
            <div id="count15LF">15 Acertos: 0x</div>
        </div>
        <div class="aviso-legal">
            ‚ö†Ô∏è <b>Aviso:</b> Este site/aplicativo √© uma ferramenta independente para facilitar a confer√™ncia de jogos. N√£o nos responsabilizamos por eventuais inconsist√™ncias nos resultados apresentados. Este site/aplicativo <b>n√£o garante ganhos reais ou pr√™mios nos concursos futuros</b>. E n√£o possui v√≠nculo com a Caixa Econ√¥mica Federal. <b>Sempre confira seu bilhete oficial no site das Lot√©rias Caixa.</b><br><br>
                <b>üîû APOSTAR √â PARA MAIORES DE 18 ANOS</b>
           <!-- (LINK Q MUDA PRA OUTRA PAGINA) <a href="https://www.caixa.gov.br/jogo-responsavel/Paginas/default.aspx" target="_blank" class="aviso-link">Acesse aqui o Guia do Jogo Respons√°vel</a> -->
        </div>


	<div style="text-align: center; font-size: 12px; color: #666; padding: 0px 0;" >
 	   <div style="position: relative; display: inline-block;" >
    	    <span style="border-bottom: 1px dashed #999;">
     	       üë®‚Äçüíª Desenvolvido por: AIRON GON√áALVES DE MOURA
     	   </span><br>

		<span style="font-size: 18px; cursor: pointer;" onclick="showTooltip()">üìß</span>  
		<span style="cursor: pointer;" onclick="showTooltip()">Contato</span>
    		<span class="tooltip-box" id="meuBalao" style="font-size: 14px">aironagm@gmail.com</span> 
   		 </div>
	</div>



   </div>

    <div id="cont-megasena" class="container ms-theme">
        <h2 style="color:var(--cor-megasena)">Mega-Sena</h2>
        <div class="busca-concurso">
            <button class="btn-nav aba-megasena" onclick="navegarConcurso('megasena', -1)">-</button>
            <input type="number" id="numMS" placeholder="N¬∫">
            <button class="btn-nav aba-megasena" onclick="navegarConcurso('megasena', 1)">+</button>
            <button class="btn-busca" onclick="resetarEBuscar('megasena', document.getElementById('numMS').value)">Buscar</button>
        </div>
        <p id="infoMS" class="concurso-info">Carregando...</p>
        <div id="bolasMS" class="bolas-container"></div>
        <div id="resumoMS" class="resumo-geral">Aguardando...</div>
        <div class="add-jogo-section">
            <label><b>Cadastrar Jogo:</b></label>
            <div style="display: flex; gap: 5px;">
                <input type="text" id="inputMS" placeholder="Digite de 6 a 20 n√∫meros" style="flex: 1;">
                <button onclick="abrirSelecionadorNumeros('megasena')" style="background: var(--cor-megasena); color: white; border: none; border-radius: 5px; width: 40px; cursor: pointer; font-weight: bold; font-size: 18px;">üéØ</button>
            </div>
            <button class="btn btn-add-ms" onclick="adicionarJogo('megasena')">Salvar Jogo na Lista</button>
            <button class="btn btn-random" onclick="gerarSurpresinha('megasena')">üé≤ Gerar Surpresinha (6 n√∫meros)</button>
        </div>
        <div class="secao-memoria">
            <button class="btn-guardar" onclick="prepararSalvamentoSlot('megasena')">üíæ Guardar Lista Atual em um Slot</button>
            <div class="grid-memoria">
                <button class="btn-memoria btn-memoria-ms-A" onclick="carregarSlot('megasena', 'A')">Jogo A</button>
                <button class="btn-memoria btn-memoria-ms-B" onclick="carregarSlot('megasena', 'B')">Jogo B</button>
                <button class="btn-memoria btn-memoria-ms-C" onclick="carregarSlot('megasena', 'C')">Jogo C</button>
                <button class="btn-memoria btn-memoria-ms-D" onclick="carregarSlot('megasena', 'D')">Jogo D</button>
                <button class="btn-memoria btn-memoria-ms-E" onclick="carregarSlot('megasena', 'E')">Jogo E</button>
            </div>
        </div>
        <div id="listaMS"></div>
        <button class="btn btn-limpar" onclick="confirmarLimpar('megasena')">Apagar Tudo</button>
        <div class="painel-financeiro" id="finMS">
            <div class="financeiro-item"><span>Total Gasto:</span> <span id="valInvestidoMS">R$ 0,00</span></div>
            <div class="financeiro-item"><span>Total de Ganhos:</span> <span id="valGanhoMS">R$ 0,00</span></div>
            <div class="financeiro-total" id="statusMS">Saldo: R$ 0,00</span></div>
        </div>
        <div id="contagemEspecialMS" class="contagem-especial">
            <strong>üèÜ Pr√™mios de Elite Acumulados:</strong>
            <div id="count14MS">Quina: 0x</div>
            <div id="count15MS">Sena: 0x</div>
        </div>
        <div class="aviso-legal">
            ‚ö†Ô∏è <b>Aviso:</b> Este site/aplicativo √© uma ferramenta independente para facilitar a confer√™ncia de jogos. N√£o nos responsabilizamos por eventuais inconsist√™ncias nos resultados apresentados. Este site/aplicativo <b>n√£o garante ganhos reais ou pr√™mios nos concursos futuros</b>. E n√£o possui v√≠nculo com a Caixa Econ√¥mica Federal. <b>Sempre confira seu bilhete oficial no site das Lot√©rias Caixa.</b><br><br>
            <b>üîû APOSTAR √â PARA MAIORES DE 18 ANOS</b>
            <!-- (LINK Q MUDA PRA OUTRA PAGINA)<a href="https://www.caixa.gov.br/jogo-responsavel/Paginas/default.aspx" target="_blank" class="aviso-link">Acesse aqui o Guia do Jogo Respons√°vel</a> -->
        </div>

	<div style="text-align: center; font-size: 12px; color: #666; padding: 0px 0;" >
 	   <div style="position: relative; display: inline-block;" >
    	    <span style="border-bottom: 1px dashed #999;">
     	       üë®‚Äçüíª Desenvolvido por: AIRON GON√áALVES DE MOURA
     	   </span><br>

		<span style="font-size: 18px; cursor: pointer;" onclick="showTooltip()">üìß</span>  
		<span style="cursor: pointer;" onclick="showTooltip()">Contato:  aironagm@gmail.com</span>
   		 </div>
	</div>
	
    </div>


    <script>

        // =============================================
        // C√ìDIGO PRINCIPAL - FUN√á√ïES ORIGINAIS
        // =============================================

	// ---- DETECTA SE √â MOBILE ----
	const isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);
        
        // --- L√ìGICA DE BITS (BITWISE) ---
        function dezenasParaMask(dezenas) {
            let mask = 0n;
            dezenas.forEach(n => {
                mask |= (1n << BigInt(n));
            });
            return mask;
        }
        function conferirVeloz(maskJogo, maskSorteio) {
            let intersec = maskJogo & maskSorteio;
            let c = 0;
            while (intersec > 0n) {
                intersec &= (intersec - 1n);
                c++;
            }
            return c;
        }

        // --- L√ìGICA DE √ÅUDIO (ALERTA DE ELITE) ---
        function tocarAlertaElite() {
            try {
                const context = new (window.AudioContext || window.webkitAudioContext)();
                const oscillator = context.createOscillator();
                const gainNode = context.createGain();
                oscillator.type = 'triangle';
                oscillator.frequency.setValueAtTime(880, context.currentTime);
                oscillator.frequency.exponentialRampToValueAtTime(1320, context.currentTime + 0.1);
                gainNode.gain.setValueAtTime(0.1, context.currentTime);
                gainNode.gain.exponentialRampToValueAtTime(0.01, context.currentTime + 0.5);
                oscillator.connect(gainNode);
                gainNode.connect(context.destination);
                oscillator.start();
                oscillator.stop(context.currentTime + 0.5);
            } catch (e) {}
        }

        let abortarConsultaMassa = false;

        function carregarJogos(tipo) {
            let storage = JSON.parse(localStorage.getItem(tipo === 'lotofacil' ? 'jogos_LF' : 'jogos_MS')) || [];
            return storage.map(j => {
                if (Array.isArray(j)) return { numeros: j, vitorias: 0, vitorias12: 0, vitorias13: 0, ganhoAcumulado: 0, concursosVistos: [] };
                if (!j.vitorias) j.vitorias = 0;
                if (!j.vitorias12) j.vitorias12 = 0;
                if (!j.vitorias13) j.vitorias13 = 0;
                if (!j.ganhoAcumulado) j.ganhoAcumulado = 0;
                if (!j.concursosVistos) j.concursosVistos = [];
                return j;
            });
        }

        let dados = {
            lotofacil: { ganhadores: [], meusJogos: carregarJogos('lotofacil'), api: 'lotofacil', min: 15, max: 20, max_bolas: 15, range: 25, custo: 3.50 },
            megasena: { ganhadores: [], meusJogos: carregarJogos('megasena'), api: 'megasena', min: 6, max: 20, max_bolas: 6, range: 60, custo: 6.00 }
        };

        let financeiroH = {
            lotofacil: { investido: 0, ganho: 0, concursos_vistos: [] },
            megasena: { investido: 0, ganho: 0, concursos_vistos: [] }
        };

        let contagemElite = {
            lotofacil: { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] },
            megasena: { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] }
        };

        // =============================================
        // ATUALIZA√á√ÉO 01: MODAL PARA SELECIONAR N√öMEROS
        // =============================================
        let tipoLoteriaAtual = '';
        let numerosSelecionados = [];
        
        function abrirSelecionadorNumeros(tipo) {
            tipoLoteriaAtual = tipo;
            numerosSelecionados = [];
            
            const modal = document.getElementById('modalNumeros');
            const grid = document.getElementById('numerosGrid');
            grid.innerHTML = '';
            
            const range = tipo === 'lotofacil' ? 25 : 60;
            
            for (let i = 1; i <= range; i++) {
                const btn = document.createElement('button');
                btn.className = 'numero-btn';
                btn.textContent = i.toString().padStart(2, '0');
                btn.dataset.numero = i;
                btn.onclick = () => toggleNumeroSelecionado(i);
                grid.appendChild(btn);
            }
            
            atualizarContadorSelecionados();
            modal.style.display = 'flex';
        }
        
        function toggleNumeroSelecionado(numero) {
            const index = numerosSelecionados.indexOf(numero);
            const maxNumeros = tipoLoteriaAtual === 'lotofacil' ? 20 : 15;
            
            if (index === -1) {
                if (numerosSelecionados.length >= maxNumeros) {
                    mostrarToastScanner(`M√°ximo de ${maxNumeros} n√∫meros permitidos`, 'alerta', 'center');
                    return;
                }
                numerosSelecionados.push(numero);
            } else {
                numerosSelecionados.splice(index, 1);
            }
            
            atualizarContadorSelecionados();
        }
        
        function atualizarContadorSelecionados() {
            const contador = document.getElementById('contadorSelecionados');
            const min = tipoLoteriaAtual === 'lotofacil' ? 15 : 6;
            const max = tipoLoteriaAtual === 'lotofacil' ? 20 : 15;
            
            contador.textContent = `Selecionados: ${numerosSelecionados.length}/${max} (M√≠nimo: ${min})`;
            
            // Atualizar apar√™ncia dos bot√µes
            document.querySelectorAll('.numero-btn').forEach(btn => {
                const num = parseInt(btn.dataset.numero);
                if (numerosSelecionados.includes(num)) {
                    btn.classList.add('selecionado');
                    btn.style.backgroundColor = tipoLoteriaAtual === 'lotofacil' ? 'var(--cor-lotofacil)' : 'var(--cor-megasena)';
                    btn.style.borderColor = tipoLoteriaAtual === 'lotofacil' ? 'var(--cor-lotofacil)' : 'var(--cor-megasena)';
                } else {
                    btn.classList.remove('selecionado');
                    btn.style.backgroundColor = 'white';
                    btn.style.borderColor = '#ddd';
                }
            });
        }
        
        function limparSelecaoNumeros() {
            numerosSelecionados = [];
            atualizarContadorSelecionados();
        }
        
        function fecharModalNumeros() {
            document.getElementById('modalNumeros').style.display = 'none';
        }
        
        function confirmarSelecaoNumeros() {
            const min = tipoLoteriaAtual === 'lotofacil' ? 15 : 6;
            
            if (numerosSelecionados.length < min) {
                mostrarToastScanner(`Selecione pelo menos ${min} n√∫meros`, 'alerta', 'center');
                return;
            }
            
            const numerosOrdenados = [...numerosSelecionados].sort((a, b) => a - b);
            const inputId = tipoLoteriaAtual === 'lotofacil' ? 'inputLF' : 'inputMS';
            document.getElementById(inputId).value = numerosOrdenados.join(' ');
            
            fecharModalNumeros();
            mostrarToastScanner(`${numerosSelecionados.length} n√∫meros selecionados!`, 'sucesso', 'center');
        }

        // =============================================
        // ATUALIZA√á√ÉO 02: OP√á√ÉO DE SALVAR SLOT VAZIO
        // =============================================
        function prepararSalvamentoSlot(tipo) {
    const temJogos = dados[tipo].meusJogos.length > 0;
    const modal = document.getElementById('modalCustom');
    const msgEl = document.getElementById('modalMsg');
    const containerBotoes = document.getElementById('modalContainerBotoes');
    
    if (!temJogos) {
        msgEl.innerText = "N√£o h√° jogos na tela para salvar. Deseja salvar um slot vazio?";
        containerBotoes.innerHTML = '';
        
        // Bot√£o para salvar vazio
        const btnSimVazio = document.createElement('button');
        btnSimVazio.className = 'btn-modal btn-sim';
        btnSimVazio.innerText = 'Salvar Slot Vazio';
        btnSimVazio.onclick = () => {
            modal.style.display = 'none';
            exibirSelecaoSlotVazio(tipo);
        };
        containerBotoes.appendChild(btnSimVazio);
        
        // Bot√£o Cancelar
        const btnNao = document.createElement('button');
        btnNao.className = 'btn-modal btn-nao';
        btnNao.innerText = 'Cancelar';
        btnNao.onclick = () => {
            modal.style.display = 'none';
            restaurarBotoesModal();
        };
        containerBotoes.appendChild(btnNao);
        
        modal.style.display = 'flex';
        return;
    }

    // Se houver jogos, continua com o fluxo original
    msgEl.innerText = "Em qual Slot deseja guardar?";
    containerBotoes.innerHTML = '';
    ['A', 'B', 'C', 'D', 'E'].forEach(slot => {
        const btn = document.createElement('button');
        const existeSalvo = localStorage.getItem(`slot_${tipo}_${slot}`);
        btn.className = 'btn-modal btn-sim';
        if (existeSalvo) {
            // Verifica se √© um slot vazio
            try {
                const dadosSlot = JSON.parse(existeSalvo);
                if (dadosSlot.length === 0 || (dadosSlot.length === 1 && dadosSlot[0].numeros && dadosSlot[0].numeros.length === 0)) {
                    btn.innerText = `Jogo ${slot} (Vazio)`;
                    btn.style.backgroundColor = '#999';
                } else {
                    btn.style.opacity = "0.6";
                    btn.innerText = `Jogo ${slot} (Ocupado)`;
                }
            } catch {
                btn.style.opacity = "0.6";
                btn.innerText = `Jogo ${slot} (Ocupado)`;
            }
        } else {
            btn.innerText = `Jogo ${slot} (Vazio)`;
        }
        btn.onclick = () => {
            // Verifica novamente no momento do clique
            const dadosAtuais = localStorage.getItem(`slot_${tipo}_${slot}`);
            
            if (!dadosAtuais) {
                // Slot realmente vazio (nunca foi salvo)
                executarSalvarSlot(tipo, slot);
                modal.style.display = 'none';
            } else {
                try {
                    const dadosSlot = JSON.parse(dadosAtuais);
                    // Verifica se √© um slot vazio (array vazio ou estrutura de jogo vazio)
                    if (dadosSlot.length === 0 || (dadosSlot.length === 1 && dadosSlot[0].numeros && dadosSlot[0].numeros.length === 0)) {
                        // Slot est√° vazio, pode salvar direto
                        executarSalvarSlot(tipo, slot);
                        modal.style.display = 'none';
                    } else {
                        // Slot realmente tem jogos
                        modal.style.display = 'none';
                        exibirModal(`O Slot ${slot} j√° tem jogos salvos. Tem certeza que deseja APAGAR os antigos e salvar a lista atual?`, () => {
                            executarSalvarSlot(tipo, slot);
                        }, false);
                    }
                } catch {
                    // Erro ao parsear, considera como ocupado
                    modal.style.display = 'none';
                    exibirModal(`O Slot ${slot} j√° tem jogos salvos. Tem certeza que deseja APAGAR os antigos e salvar a lista atual?`, () => {
                        executarSalvarSlot(tipo, slot);
                    }, false);
                }
            }
        };
        containerBotoes.appendChild(btn);
    });
    const btnCanc = document.createElement('button');
    btnCanc.className = 'btn-modal btn-nao';
    btnCanc.innerText = 'Cancelar';
    btnCanc.onclick = () => {
        restaurarBotoesModal();
        modal.style.display = 'none';
    };
    containerBotoes.appendChild(btnCanc);
    modal.style.display = 'flex';
}

// Fun√ß√£o para exibir sele√ß√£o de slot vazio
function exibirSelecaoSlotVazio(tipo) {
    const modal = document.getElementById('modalCustom');
    const msgEl = document.getElementById('modalMsg');
    const containerBotoes = document.getElementById('modalContainerBotoes');
    
    msgEl.innerText = "Selecione um slot para salvar como vazio:";
    containerBotoes.innerHTML = '';
    
    ['A', 'B', 'C', 'D', 'E'].forEach(slot => {
        const btn = document.createElement('button');
        const existeSalvo = localStorage.getItem(`slot_${tipo}_${slot}`);
        btn.className = 'btn-modal btn-sim';
        if (existeSalvo) {
            // Verifica se √© um slot vazio
            try {
                const dadosSlot = JSON.parse(existeSalvo);
                if (dadosSlot.length === 0 || (dadosSlot.length === 1 && dadosSlot[0].numeros && dadosSlot[0].numeros.length === 0)) {
                    btn.innerText = `Jogo ${slot} (Vazio)`;
                    btn.style.backgroundColor = '#999';
                } else {
                    btn.style.opacity = "0.6";
                    btn.innerText = `Jogo ${slot} (Ocupado)`;
                }
            } catch {
                btn.style.opacity = "0.6";
                btn.innerText = `Jogo ${slot} (Ocupado)`;
            }
        } else {
            btn.innerText = `Jogo ${slot} (Vazio)`;
        }
        btn.onclick = () => {
            // Verifica novamente no momento do clique
            const dadosAtuais = localStorage.getItem(`slot_${tipo}_${slot}`);
            
            if (!dadosAtuais) {
                // Slot realmente vazio (nunca foi salvo)
                salvarSlotVazio(tipo, slot);
                modal.style.display = 'none';
            } else {
                try {
                    const dadosSlot = JSON.parse(dadosAtuais);
                    // Verifica se √© um slot vazio (array vazio ou estrutura de jogo vazio)
                    if (dadosSlot.length === 0 || (dadosSlot.length === 1 && dadosSlot[0].numeros && dadosSlot[0].numeros.length === 0)) {
                        // Slot est√° vazio, pode salvar direto
                        salvarSlotVazio(tipo, slot);
                        modal.style.display = 'none';
                    } else {
                        // Slot realmente tem jogos
                        modal.style.display = 'none';
                        exibirModal(`O Slot ${slot} j√° tem jogos salvos. Tem certeza que deseja APAGAR os antigos e salvar a lista atual?`, () => {
                            salvarSlotVazio(tipo, slot);
                        }, false);
                    }
                } catch {
                    // Erro ao parsear, considera como ocupado
                    modal.style.display = 'none';
                    exibirModal(`O Slot ${slot} j√° tem jogos salvos. Tem certeza que deseja APAGAR os antigos e salvar a lista atual?`, () => {
                        salvarSlotVazio(tipo, slot);
                    }, false);
                }
            }
        };
        containerBotoes.appendChild(btn);
    });
    
    const btnCanc = document.createElement('button');
    btnCanc.className = 'btn-modal btn-nao';
    btnCanc.innerText = 'Cancelar';
    btnCanc.onclick = () => {
        restaurarBotoesModal();
        modal.style.display = 'none';
    };
    containerBotoes.appendChild(btnCanc);
    
    modal.style.display = 'flex';
}

// Fun√ß√£o para salvar slot vazio
function salvarSlotVazio(tipo, slot) {
    // Salva um array vazio como slot vazio
    localStorage.setItem(`slot_${tipo}_${slot}`, JSON.stringify([]));
    exibirModal(`Slot ${slot} salvo como vazio!`, null, true);
    atualizarBotoesSlot(tipo);
}

function executarSalvarSlot(tipo, slot) {
    const jogosParaSalvar = dados[tipo].meusJogos.map(j => ({
        ...j,
        vitorias: 0,
        vitorias12: 0,
        vitorias13: 0,
        ganhoAcumulado: 0,
        concursosVistos: []
    }));
    localStorage.setItem(`slot_${tipo}_${slot}`, JSON.stringify(jogosParaSalvar));
    exibirModal(`Jogos guardados com sucesso no Slot ${slot}!`, null, true);
    atualizarBotoesSlot(tipo);
}



        // Fun√ß√£o para atualizar apar√™ncia dos bot√µes de slot
        function atualizarBotoesSlot(tipo) {
            const prefixo = tipo === 'lotofacil' ? 'lf' : 'ms';
            ['A', 'B', 'C', 'D', 'E'].forEach(slot => {
                const btn = document.querySelector(`.btn-memoria-${prefixo}-${slot}`);
                if (btn) {
                    const salvo = localStorage.getItem(`slot_${tipo}_${slot}`);
                    if (salvo) {
                        try {
                            const dadosSlot = JSON.parse(salvo);
                            if (dadosSlot.length === 0 || (dadosSlot.length === 1 && dadosSlot[0].numeros && dadosSlot[0].numeros.length === 0)) {
                                btn.classList.add('slot-vazio');
                                btn.innerText = `Slot ${slot} (Vazio)`;
                            } else {
                                btn.classList.remove('slot-vazio');
                                btn.innerText = `Jogo ${slot}`;
                            }
                        } catch {
                            btn.classList.remove('slot-vazio');
                            btn.innerText = `Jogo ${slot}`;
                        }
                    } else {
                        btn.classList.remove('slot-vazio');
                        btn.innerText = `Jogo ${slot}`;
                    }
                }
            });
        }

        function restaurarBotoesModal() {
            document.getElementById('modalContainerBotoes').innerHTML = `
                <button id="btnSim" class="btn-modal btn-sim">Confirmar</button>
                <button id="btnNao" class="btn-modal btn-nao">Cancelar</button>
            `;
        }

        function carregarSlot(tipo, slot) {
            const salvo = localStorage.getItem(`slot_${tipo}_${slot}`);
            if (salvo) {
                try {
                    const dadosSlot = JSON.parse(salvo);
                    // Verifica se √© um slot vazio
                    if (dadosSlot.length === 0 || (dadosSlot.length === 1 && dadosSlot[0].numeros && dadosSlot[0].numeros.length === 0)) {
                        exibirModal(`O Jogo ${slot} est√° vazio.`, null, true);
                        return;
                    }
                    
                    financeiroH[tipo] = { investido: 0, ganho: 0, concursos_vistos: [] };
                    contagemElite[tipo] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
                    dados[tipo].meusJogos = dadosSlot;
                    salvarNoLocalStorage(tipo);
                    renderizar(tipo);
                    const prefixo = tipo === 'lotofacil' ? 'lf' : 'ms';
                    document.querySelectorAll(`.btn-memoria`).forEach(btn => {
                        if(btn.className.includes(`btn-memoria-${prefixo}`)) btn.classList.remove('slot-active');
                    });
                    const btnSel = document.querySelector(`.btn-memoria-${prefixo}-${slot}`);
                    if(btnSel) btnSel.classList.add('slot-active');
                    exibirModal(`Jogo ${slot} carregado para confer√™ncia!`, null, true);
                } catch (e) {
                    exibirModal(`Erro ao carregar o Jogo ${slot}.`, null, true);
                }
            } else {
                exibirModal(`O Jogo ${slot} est√° vazio.`, null, true);
            }
        }

        function exibirModal(msg, callback, apenasAviso = false) {
            restaurarBotoesModal();
            const modal = document.getElementById('modalCustom');
            const msgEl = document.getElementById('modalMsg');
            const btnSim = document.getElementById('btnSim');
            const btnNao = document.getElementById('btnNao');
            msgEl.innerText = msg;
            modal.style.display = 'flex';
            btnNao.style.display = apenasAviso ? 'none' : 'block';
            btnSim.innerText = apenasAviso ? 'OK' : 'Confirmar';
            btnSim.onclick = () => {
                modal.style.display = 'none';
                if (callback) callback();
            };
            btnNao.onclick = () => {
                modal.style.display = 'none';
            };
        }

        function switchTab(tipo) {
            document.querySelectorAll('.container, .btn-aba').forEach(el => el.classList.remove('active'));
            document.getElementById(`cont-${tipo}`).classList.add('active');
            document.querySelector(`.aba-${tipo}`).classList.add('active');
            document.body.className = `${tipo === 'lotofacil' ? 'lf' : 'ms'}-theme`;
        }


 // =============================================
 // ATUALIZA√á√ÉO 03: FUN√á√ÉO BUSCAR COM M√öLTIPLAS APIS
 // =============================================
        async function buscar(tipo, concurso = 'latest') {
            const idInfo = tipo === 'lotofacil' ? 'infoLF' : 'infoMS';
            const idInput = tipo === 'lotofacil' ? 'numLF' : 'numMS';
            const idBolas = tipo === 'lotofacil' ? 'bolasLF' : 'bolasMS';
            const bolasEl = document.getElementById(idBolas);
            
            const termo = (concurso === '' || concurso === null) ? 'latest' : concurso;
            
            // Lista de APIs de fallback
            const apis = [
                `https://loteriascaixa-api.herokuapp.com/api/${dados[tipo].api}/${termo}`,
                `https://api-loteria.vercel.app/api/${dados[tipo].api}/${termo}`,
                `https://www.lotodicas.com.br/api/${dados[tipo].api}/${termo}`
            ];
            
            let data = null;
            let lastError = null;
            
            // Tenta cada API at√© conseguir uma resposta
            for (let apiUrl of apis) {
                try {
                    console.log(`Tentando API: ${apiUrl}`);
                    const response = await fetch(apiUrl, { timeout: 10000 });
                    if (!response.ok) throw new Error(`API ${apiUrl} falhou com status ${response.status}`);
                    data = await response.json();
                    console.log(`Sucesso com API: ${apiUrl}`);
                    break; // Sai do loop se conseguir
                } catch (error) {
                    console.warn(`Falha com API ${apiUrl}:`, error);
                    lastError = error;
                    continue; // Tenta pr√≥xima API
                }
            }
            
            if (data) {
                dados[tipo].concursoAtual = data.concurso || data.numero_concurso || data.numero;
                document.getElementById(idInput).value = dados[tipo].concursoAtual;
                
                // Extrai as dezenas de diferentes formatos de API
                let dezenas = [];
                if (data.dezenas) {
                    dezenas = data.dezenas.map(Number);
                } else if (data.numeros) {
                    dezenas = data.numeros.map(Number);
                } else if (data.numeros_sorteados) {
                    dezenas = data.numeros_sorteados.map(Number);
                }
                
                dados[tipo].ganhadores = dezenas;
                
                // Formata a data
                const dataFormatada = data.data ? data.data : (data.data_sorteio ? data.data_sorteio : 'Data n√£o dispon√≠vel');
                document.getElementById(idInfo).innerHTML = `Concurso ${dados[tipo].concursoAtual} - Data: ${dataFormatada}`;
                
                bolasEl.innerHTML = '';
                dezenas.forEach(num => {
                    bolasEl.innerHTML += `<div class="bola">${num}</div>`;
                });
                renderizar(tipo);
                return dados[tipo].concursoAtual;
            } else {
                // Se todas as APIs falharem
                document.getElementById(idInfo).innerHTML = `<span style="color:#d93025">‚ö†Ô∏è CONCURSO N√ÉO ENCONTRADO OU N√ÉO SORTEADO</span>`;
                bolasEl.innerHTML = '';
                for(let i=0; i < dados[tipo].max_bolas; i++) bolasEl.innerHTML += `<div class="bola" style="background:#ccc; color:#666">- -</div>`;
                dados[tipo].ganhadores = [];
                renderizar(tipo);
                return null;
            }
        }

        function limparEstatisticasJogos(tipo) {
            dados[tipo].meusJogos = dados[tipo].meusJogos.map(j => {
                return {
                    numeros: j.numeros,
                    vitorias: 0,
                    vitorias12: 0,
                    vitorias13: 0,
                    ganhoAcumulado: 0,
                    concursosVistos: []
                };
            });
            salvarNoLocalStorage(tipo);
        }

        // =============================================
        // ATUALIZA√á√ÉO 04: CONCURSO FINAL NO SCANNER
        // =============================================
        async function conferirMassa(tipo) {
            const inputMassa = document.getElementById(`massa_${tipo}`);
            const btnMassa = document.getElementById(`btnMassa_${tipo}`);
            const progContainer = document.getElementById(`progContainer_${tipo}`);
            const progBar = document.getElementById(`progBar_${tipo}`);
            
            if (btnMassa.dataset.status === "rodando") {
                abortarConsultaMassa = true;
                return;
            }
            
            let inicio = parseInt(inputMassa.value);
            if (isNaN(inicio) || inicio <= 0) {
                exibirModal("Digite um concurso inicial v√°lido.", null, true);
                return;
            }
            
            const originalText = "üîç Conferir at√© o Fim";
            
            try {
                const respLatest = await fetch(`https://loteriascaixa-api.herokuapp.com/api/${dados[tipo].api}/latest`);
                const dataLatest = await respLatest.json();
                const fim = dataLatest.concurso;
                
                if (inicio > fim) {
                    exibirModal("Concurso inicial maior que o atual.", null, true);
                    return;
                }
                
                const total = fim - inicio + 1;
                
                const iniciarLoop = async () => {
                    abortarConsultaMassa = false;
                    btnMassa.dataset.status = "rodando";
                    btnMassa.style.backgroundColor = "#ff4444";
                    progContainer.style.display = 'block';
                    progBar.style.width = '0%';
                    zerarFinanceiro(tipo);
                    contagemElite[tipo] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
                    limparEstatisticasJogos(tipo);
                    
                    for (let c = inicio; c <= fim; c++) {
                        if (abortarConsultaMassa) break;
                        const percent = (((c - inicio + 1) / total) * 100).toFixed(0);
                        progBar.style.width = percent + '%';
                        btnMassa.innerText = `Parar - ‚è≥ Processando... (${percent}%)`;
                        await buscar(tipo, c);
                    }
                    
                    btnMassa.dataset.status = "parado";
                    btnMassa.innerText = originalText;
                    btnMassa.style.backgroundColor = "#f39c12";
                    
                    if (abortarConsultaMassa) {
                        exibirModal("Consulta interrompida pelo usu√°rio.", null, true);
                    } else {
                        exibirModal(`Confer√™ncia finalizada do ${inicio} ao ${fim}!`, null, true);
                    }
                    
                    setTimeout(() => {
                        progContainer.style.display = 'none';
                    }, 2000);
                };
                
                if (total > 300) {
                    exibirModal(`Voc√™ est√° prestes a consultar ${total} concursos. Deseja continuar?`, iniciarLoop);
                } else {
                    iniciarLoop();
                }
            } catch (err) {
                exibirModal("Erro na confer√™ncia em massa.", null, true);
                btnMassa.dataset.status = "parado";
                btnMassa.innerText = originalText;
                btnMassa.style.backgroundColor = "#f39c12";
            }
        }

        function navegarConcurso(tipo, direcao) {
            const id = tipo === 'lotofacil' ? 'numLF' : 'numMS';
            let val = parseInt(document.getElementById(id).value);
            if(!isNaN(val)) buscar(tipo, val + direcao);
        }

        function gerarSurpresinha(tipo) {
            let numeros = [];
            while(numeros.length < dados[tipo].min) {
                let n = Math.floor(Math.random() * dados[tipo].range) + 1;
                if(!numeros.includes(n)) numeros.push(n);
            }
            numeros.sort((a,b) => a - b);
            dados[tipo].meusJogos.push({
                numeros: numeros,
                vitorias: 0,
                vitorias12: 0,
                vitorias13: 0,
                ganhoAcumulado: 0,
                concursosVistos: []
            });
            salvarNoLocalStorage(tipo);
            renderizar(tipo);
        }

        async function gerar50Jogos(tipo) {
            const btn = document.getElementById(`btn50_${tipo}`);
            const textoOriginal = btn.innerHTML;
            btn.innerHTML = "‚è≥ Gerando 50 Jogos...";
            btn.disabled = true;
            await new Promise(r => setTimeout(r, 200));
            for(let i=0; i<50; i++) {
                gerarSurpresinha(tipo);
            }
            btn.disabled = false;
            btn.innerHTML = textoOriginal;
            exibirModal("50 jogos gerados com sucesso!", null, true);
        }

        function adicionarJogo(tipo) {
            const input = document.getElementById(tipo === 'lotofacil' ? 'inputLF' : 'inputMS');
            let nums = input.value.split(/[\s,]+/).filter(n => n !== "").map(Number);
            const limiteMaximo = dados[tipo].range;
            if (nums.filter(n => n < 1 || n > limiteMaximo).length > 0) {
                exibirModal(`‚ö†Ô∏è N√∫meros fora do intervalo (01 a ${limiteMaximo})`, null, true);
                return;
            }
            let unicos = [...new Set(nums)];
            if (unicos.length !== nums.length) {
                exibirModal("‚ö†Ô∏è N√∫meros repetidos detectados!", null, true);
                return;
            }
            if (unicos.length < dados[tipo].min || unicos.length > dados[tipo].max) {
                exibirModal(`Digite entre ${dados[tipo].min} e ${dados[tipo].max} n√∫meros.`, null, true);
                return;
            }
            unicos.sort((a,b) => a-b);
            dados[tipo].meusJogos.push({
                numeros: unicos,
                vitorias: 0,
                vitorias12: 0,
                vitorias13: 0,
                ganhoAcumulado: 0,
                concursosVistos: []
            });
            salvarNoLocalStorage(tipo);
            input.value = '';
            renderizar(tipo);
        }

        function salvarNoLocalStorage(tipo) {
            localStorage.setItem(tipo === 'lotofacil' ? 'jogos_LF' : 'jogos_MS', JSON.stringify(dados[tipo].meusJogos));
        }

        function confirmarRemover(tipo, index) {
            exibirModal("Deseja excluir este jogo?", () => {
                dados[tipo].meusJogos.splice(index, 1);
                salvarNoLocalStorage(tipo);
                renderizar(tipo);
            });
        }

        function confirmarLimpar(tipo) {
            exibirModal(`Deseja apagar todos os jogos de ${tipo}?`, () => {
                dados[tipo].meusJogos = [];
                localStorage.removeItem(tipo === 'lotofacil' ? 'jogos_LF' : 'jogos_MS');
                financeiroH[tipo] = { investido: 0, ganho: 0, concursos_vistos: [] };
                contagemElite[tipo] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
                renderizar(tipo);
            });
        }

        function renderizar(tipo) {
            const lista = document.getElementById(tipo === 'lotofacil' ? 'listaLF' : 'listaMS');
            const resumo = document.getElementById(tipo === 'lotofacil' ? 'resumoLF' : 'resumoMS');
            const classeAcerto = tipo === 'lotofacil' ? 'num-acertado-lf' : 'num-acertado-ms';
            if (dados[tipo].meusJogos.length === 0) {
                lista.innerHTML = '<h3>Meus Jogos Salvos:</h3>';
                resumo.innerHTML = "Nenhum jogo salvo.";
                atualizarPainelFinanceiro(tipo);
                atualizarPainelElite(tipo);
                return;
            }
            const concursoAtual = dados[tipo].concursoAtual;
            const maskSorteio = dezenasParaMask(dados[tipo].ganhadores);
            let totalInvestidoConcurso = dados[tipo].meusJogos.length * dados[tipo].custo;
            let totalGanhoConcurso = 0;
            let totalPremiados = 0;
            let stats = {};
            let acertoElite14 = false;
            let acertoElite15 = false;
            dados[tipo].meusJogos.forEach(jogo => {
                const maskJogo = dezenasParaMask(jogo.numeros);
                const acertos = conferirVeloz(maskJogo, maskSorteio);
                const minimoParaGanhar = (tipo === 'lotofacil' ? 11 : 4);
                const ganhou = acertos >= minimoParaGanhar && dados[tipo].ganhadores.length > 0;
                if (dados[tipo].ganhadores.length > 0) {
                    if (tipo === 'lotofacil') {
                        if (acertos === 14) acertoElite14 = true;
                        if (acertos === 15) acertoElite15 = true;
                    } else {
                        if (acertos === 5) acertoElite14 = true;
                        if (acertos === 6) acertoElite15 = true;
                    }
                }
                let valorGanhoNeste = 0;
                if(ganhou && tipo === 'lotofacil') {
                    if(acertos === 11) valorGanhoNeste = 7.00;
                    if(acertos === 12) valorGanhoNeste = 14.00;
                    if(acertos === 13) valorGanhoNeste = 35.00;
                }
                if (ganhou) {
                    if (concursoAtual && !jogo.concursosVistos.includes(concursoAtual)) {
                        jogo.vitorias = (jogo.vitorias || 0) + 1;
                        if(tipo === 'lotofacil' && acertos === 12) jogo.vitorias12 = (jogo.vitorias12 || 0) + 1;
                        if(tipo === 'lotofacil' && acertos === 13) jogo.vitorias13 = (jogo.vitorias13 || 0) + 1;
                        jogo.ganhoAcumulado = (jogo.ganhoAcumulado || 0) + valorGanhoNeste;
                        jogo.concursosVistos.push(concursoAtual);
                    }
                    totalPremiados++;
                    stats[acertos] = (stats[acertos] || 0) + 1;
                    totalGanhoConcurso += valorGanhoNeste;
                }
                jogo.ultimoAcertoTemp = acertos;
            });
            if (concursoAtual && !contagemElite[tipo].concursos_processados.includes(concursoAtual) && dados[tipo].ganhadores.length > 0) {
                if (acertoElite14) {
                    contagemElite[tipo].c14++;
                    contagemElite[tipo].lista14.push(concursoAtual);
                    tocarAlertaElite();
                }
                if (acertoElite15) {
                    contagemElite[tipo].c15++;
                    contagemElite[tipo].lista15.push(concursoAtual);
                    tocarAlertaElite();
                }
                contagemElite[tipo].concursos_processados.push(concursoAtual);
            }
            processarAcumulo(tipo, totalInvestidoConcurso, totalGanhoConcurso);
            salvarNoLocalStorage(tipo);
            dados[tipo].meusJogos.sort((a, b) => (b.ganhoAcumulado || 0) - (a.ganhoAcumulado || 0) || (b.vitorias || 0) - (a.vitorias || 0));
            lista.innerHTML = '<h3>Meus Jogos Salvos:</h3>';
            dados[tipo].meusJogos.forEach((jogo, idx) => {
                const acertos = jogo.ultimoAcertoTemp;
                const ganhou = acertos >= (tipo === 'lotofacil' ? 11 : 4) && dados[tipo].ganhadores.length > 0;
                const htmlJogo = jogo.numeros.map(n => (dados[tipo].ganhadores.includes(n)) ? `<span class="${classeAcerto}">${n.toString().padStart(2, '0')}</span>` : n.toString().padStart(2, '0')).join(' ');
                lista.innerHTML += `
                <div class="card-jogo ${ganhou ? 'premiado' : ''}">
                    <button class="remove-btn" onclick="confirmarRemover('${tipo}', ${idx})">X</button>
                    <div style="font-family: monospace; font-size: 1.1em; margin-bottom:5px;">${htmlJogo}</div>
                    <small><b>${acertos} ACERTOS</b></small>
                    ${jogo.vitorias > 0 ? `<span class="badge-vitorias">üèÜ ${jogo.vitorias}x Premiado</span>` : ''}
                    ${tipo === 'lotofacil' && jogo.vitorias12 > 0 ? `<span class="badge-doze">‚ú® 12 pts: ${jogo.vitorias12}x</span>` : ''}
                    ${tipo === 'lotofacil' && jogo.vitorias13 > 0 ? `<span class="badge-treze">üî• 13 pts: ${jogo.vitorias13}x</span>` : ''}
                    ${jogo.ganhoAcumulado > 0 ? `<span class="badge-dinheiro">üí∞ Total: R$ ${jogo.ganhoAcumulado.toFixed(2)}</span>` : ''}
                </div>`;
            });
            if (dados[tipo].ganhadores.length > 0) {
                if (totalPremiados > 0) {
                    let resumoHtml = `<strong>üéâ PARAB√âNS! ${totalPremiados} jogo(s) premiado(s)!</strong><br>`;
                    [15,14,13,12,11,6,5,4].forEach(f => {
                        if (stats[f]) resumoHtml += `<div class="caixa-acerto">${stats[f]} jogo(s) de <b>${f} acertos</b></div><br>`;
                    });
                    resumo.innerHTML = resumoHtml;
                } else resumo.innerHTML = "Nenhum jogo premiado neste concurso.";
            } else resumo.innerHTML = "Aguardando resultado...";
            atualizarPainelFinanceiro(tipo);
            atualizarPainelElite(tipo);
        }

        function atualizarPainelElite(tipo) {
            const sufixo = tipo === 'lotofacil' ? 'LF' : 'MS';
            const label14 = tipo === 'lotofacil' ? '14 Acertos' : 'Quina';
            const label15 = tipo === 'lotofacil' ? '15 Acertos' : 'Sena';
            const l14 = contagemElite[tipo].lista14.length > 0 ? " - " + contagemElite[tipo].lista14.join(", ") : "";
            const l15 = contagemElite[tipo].lista15.length > 0 ? " - " + contagemElite[tipo].lista15.join(", ") : "";
            document.getElementById(`count14${sufixo}`).innerHTML = `${label14}: <b>${contagemElite[tipo].c14}x</b> <small style="color:#666">${l14}</small>`;
            document.getElementById(`count15${sufixo}`).innerHTML = `${label15}: <b>${contagemElite[tipo].c15}x</b> <small style="color:#666">${l15}</small>`;
        }

        function processarAcumulo(tipo, custo, premio) {
            const conc = dados[tipo].concursoAtual;
            if (conc && !financeiroH[tipo].concursos_vistos.includes(conc) && dados[tipo].ganhadores.length > 0) {
                financeiroH[tipo].investido += custo;
                financeiroH[tipo].ganho += premio;
                financeiroH[tipo].concursos_vistos.push(conc);
            }
        }

        function atualizarPainelFinanceiro(tipo) {
            const sufixo = tipo === 'lotofacil' ? 'LF' : 'MS';
            const saldo = financeiroH[tipo].ganho - financeiroH[tipo].investido;
            document.getElementById(`valInvestido${sufixo}`).innerText = `R$ ${financeiroH[tipo].investido.toLocaleString('pt-br', {minimumFractionDigits: 2})}`;
            document.getElementById(`valGanho${sufixo}`).innerText = `R$ ${financeiroH[tipo].ganho.toLocaleString('pt-br', {minimumFractionDigits: 2})}`;
            const el = document.getElementById(`status${sufixo}`);
            el.innerText = `Saldo: R$ ${saldo.toLocaleString('pt-br', {minimumFractionDigits: 2})}`;
            el.className = 'financeiro-total ' + (saldo > 0 ? 'lucro' : (saldo < 0 ? 'prejuizo' : ''));
        }

        function zerarFinanceiro(tipo) {
            financeiroH[tipo] = { investido: 0, ganho: 0, concursos_vistos: [] };
            atualizarPainelFinanceiro(tipo);
        }

        function resetarEBuscar(tipo, conc) {
            zerarFinanceiro(tipo);
            contagemElite[tipo] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
            limparEstatisticasJogos(tipo);
            buscar(tipo, conc);
        }

        function unificarNovosBotoes() {
            ['lotofacil', 'megasena'].forEach(tipo => {
                const container = document.querySelector(`#cont-${tipo} .add-jogo-section`);
                if (container) {
                    const hr = document.createElement('hr');
                    hr.style.margin = "10px 0";
                    hr.style.opacity = "0.3";
                    container.appendChild(hr);
                    const btn50 = document.createElement('button');
                    btn50.id = `btn50_${tipo}`;
                    btn50.className = "btn btn-random";
                    btn50.style.backgroundColor = "#2c3e50";
                    btn50.innerHTML = "üé∞ Gerar 50 Jogos Surpresinha";
                    btn50.onclick = () => {
                        gerar50Jogos(tipo);
                    };
                    container.appendChild(btn50);
                    
                    // =============================================
                    // ATUALIZA√á√ÉO 03: CONCURSO INICIAL AUTOM√ÅTICO
                    // =============================================
                    const divMassa = document.createElement('div');
                    divMassa.innerHTML = `
                        <label style="font-size:12px"><b>Confer√™ncia em Massa:</b></label>
                        <div style="display:flex; gap:5px; margin-top:5px">
                            <input type="number" id="massa_${tipo}" placeholder="Conc. Inicial" style="flex:1; padding:8px; font-size:12px">
                            <button id="btnMassa_${tipo}" class="btn" data-status="parado" style="flex:1; background:#f39c12; color:white; font-size:12px" onclick="conferirMassa('${tipo}')">üîç Conferir at√© o Fim</button>
                        </div>
                        <div id="progContainer_${tipo}" class="progress-container"><div id="progBar_${tipo}" class="progress-bar"></div></div>
                    `;
                    container.appendChild(divMassa);
                    
                    // Preencher automaticamente o concurso inicial (10 concursos antes do √∫ltimo)
                    setTimeout(async () => {
                        try {
                            const resp = await fetch(`https://loteriascaixa-api.herokuapp.com/api/${dados[tipo].api}/latest`);
                            const data = await resp.json();
                            if (data && data.concurso) {
                                const concursoInicial = Math.max(1, data.concurso - 40);
                                document.getElementById(`massa_${tipo}`).value = concursoInicial;
                            }
                        } catch (e) {
                            console.log("N√£o foi poss√≠vel obter o √∫ltimo concurso");
                        }
                    }, 1000);
                }
            });
        }




// =====================================================================
// C√ìDIGO DO SCANNER DE ALTA PERFORMANCE
// =====================================================================
        
        let scannerJogosGerados = [];

        
        function abrirScannerAltaPerformance() {
   	 document.getElementById('modalScanner').style.display = 'flex';
	
	   if (isMobile) {
      		  document.body.style.overflow = 'hidden'; // Bloqueia scroll do body
  	  }
    
 	   // Injetar o conte√∫do do scanner otimizado para mobile
	    document.getElementById('scannerContent').innerHTML = `
	        <div class="scanner-header" style="display: flex; align-items: center; margin-bottom: 20px; gap: 15px; position: relative;">
  		  <h2 style="color: #9b2a92; margin: 0; font-size: 20px; line-height: 1.3; flex: 1;">LotoF√°cil: Scanner de Alta Performance</h2>
	 	   <button class="close-scanner" onclick="fecharScanner()" style="background: #ff4444; color: white; border: none; border-radius: 50%; width: 24px; height: 24px;
        	                cursor: pointer; font-weight: bold; font-size: 14px; display: flex; align-items: center; justify-content: center; padding: 0; flex-shrink: 0;
   				 ">‚úï</button>
		</div>
        
        <div class="como-funciona" style="margin-bottom: 20px; border: 1px solid #e2e8f0; border-radius: 10px; overflow: hidden;">
    <button class="como-funciona-btn" onclick="toggleExplica√ß√£oScanner()" style="width: 100%; background: #f8fafc; border: none; padding: 12px; text-align: left; cursor: pointer; font-weight: bold; color: #9b2a92; display: flex; justify-content: space-between; align-items: center; transition: 0.3s;">
        üí° Entenda como o Scanner funciona <span id="setaComoScanner">‚ñº</span>
    </button>
    <div id="explica√ß√£oContentScanner" style="padding: 0; max-height: 0; overflow: hidden; transition: max-height 0.5s cubic-bezier(0.4, 0, 0.2, 1); background: white; color: #4a5568;">
        <div style="padding: 20px; max-height: 400px; overflow-y: auto;">
            <h3 style="color: #9b2a92; margin-top: 0; margin-bottom: 15px; border-bottom: 2px solid #f0f0f0; padding-bottom: 8px;">üìà Como o Scanner de Alta Performance Funciona</h3>
            
            <div style="margin-bottom: 20px;">
                <h4 style="color: #7b1fa2; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                    <span style="background: #9b2a92; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px;">1</span>
                    Amostragem Inteligente de Concursos
                </h4>
                <p style="margin: 0 0 10px 32px; line-height: 1.6;">
                    O sistema analisa <strong>concursos hist√≥ricos</strong> para identificar padr√µes. Quanto maior o intervalo selecionado, mais dados s√£o processados, mas tamb√©m mais dif√≠cil √© encontrar jogos que se encaixem perfeitamente em todos os crit√©rios.
                </p>
                <div style="margin-left: 32px; background: linear-gradient(90deg, #f3e5f5, #e1f5fe); padding: 10px; border-radius: 6px; font-size: 12px;">
                    <strong>Recomenda√ß√£o:</strong> Para iniciantes, use 50-100 concursos. Para an√°lises avan√ßadas, 200-300 concursos.
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <h4 style="color: #1976d2; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                    <span style="background: #2196f3; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px;">2</span>
                    Processamento de Tentativas
                </h4>
                <p style="margin: 0 0 10px 32px; line-height: 1.6;">
                    Cada <strong>tentativa</strong> representa um jogo gerado aleatoriamente e testado contra todos os concursos selecionados. Mais tentativas = maior chance de encontrar combina√ß√µes vencedoras. Mas uma quantidade muito alta de tentativas pode demorar para processar ou travar o sistema.</p>
                </p>
                <div style="margin-left: 32px; display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px;">
                    <div style="background: #e8f5e8; padding: 8px; border-radius: 6px; border-left: 3px solid #4caf50;">
                        <small><strong>Baixo (1.000-5.000):</strong><br>Processamento r√°pido, resultados b√°sicos</small>
                    </div>
                    <div style="background: #fff3e0; padding: 8px; border-radius: 6px; border-left: 3px solid #ff9800;">
                        <small><strong>M√©dio (5.000-20.000):</strong><br>Balan√ßo entre tempo e qualidade</small>
                    </div>
                    <div style="background: #fce4ec; padding: 8px; border-radius: 6px; border-left: 3px solid #e91e63;">
                        <small><strong>Alto (20.000-50.000):</strong><br>Resultados otimizados, mais tempo</small>
                    </div>
                    <div style="background: #e3f2fd; padding: 8px; border-radius: 6px; border-left: 3px solid #2196f3;">
                        <small><strong>M√°ximo (50.000+):</strong><br>Melhores resultados, pode demorar</small>
                    </div>
                </div>
            </div>
            
            <div style="margin-bottom: 20px;">
                <h4 style="color: #388e3c; margin-bottom: 8px; display: flex; align-items: center; gap: 8px;">
                    <span style="background: #4caf50; color: white; width: 24px; height: 24px; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px;">3</span>
                    Estrat√©gias de Busca
                </h4>
                <div style="margin-left: 32px;">
                    <div style="display: flex; flex-direction: column; gap: 15px;">
                        <div>
                            <h5 style="color: #9b2a92; margin: 0 0 5px 0; font-size: 14px;">üéØ Foco em Lucro Puro</h5>
                            <p style="margin: 0; font-size: 13px; line-height: 1.5;">
                                Os primeiros jogos buscam <strong>maximizar o retorno financeiro</strong> hist√≥rico, priorizando combina√ß√µes que gerariam mais pr√™mios nos concursos analisados. Mas podem deixar concursos sem premia√ß√£o (lacunas).
                            </p>
                        </div>
                        <div>
                            <h5 style="color: #209869; margin: 0 0 5px 0; font-size: 14px;">üîÑ Modo H√≠brido (Lucro + Cobertura)</h5>
                            <p style="margin: 0; font-size: 13px; line-height: 1.5;">
                                Jogos subsequentes equilibram lucro com <strong>cobertura de lacunas</strong> - preenchem concursos que ainda n√£o foram premiados, aumentando a frequ√™ncia de acertos.
                            </p>
                        </div>
                    </div>
                </div>
            </div>
            
            <div style="margin-top: 25px; padding: 15px; background: linear-gradient(135deg, #f5f7fa, #c3cfe2); border-radius: 10px; border: 1px solid #d1d9e6;">
                <h4 style="color: #5d4037; margin-top: 0; margin-bottom: 10px; display: flex; align-items: center; gap: 8px;">
                    <span style="font-size: 20px;">üíé</span> Configura√ß√£o Recomendada para Iniciantes
                </h4>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 10px; font-size: 13px;">
                    <div>
                        <strong>Concurso Inicial:</strong><br>
                        <code style="background: white; padding: 4px 8px; border-radius: 4px; font-family: monospace;">√öltimo - 100</code>
                    </div>
                    <div>
                        <strong>Qtd de Jogos:</strong><br>
                        <code style="background: white; padding: 4px 8px; border-radius: 4px; font-family: monospace;">4-6 jogos</code>
                    </div>
                    <div>
                        <strong>Tentativas Base:</strong><br>
                        <code style="background: white; padding: 4px 8px; border-radius: 4px; font-family: monospace;">10.000</code>
                    </div>
                    <div>
                        <strong>Foco Lucro:</strong><br>
                        <code style="background: white; padding: 4px 8px; border-radius: 4px; font-family: monospace;">2 jogos</code>
                    </div>
                </div>
                <p style="margin: 15px 0 0 0; font-size: 12px; color: #666; text-align: center;">
                    <em>Esta configura√ß√£o oferece um bom equil√≠brio entre tempo de processamento e qualidade dos resultados.</em>
                </p>
            </div>
        </div>
    </div>
</div>




        <div class="painel-financeiro" style="background: #1a202c; color: white; border-radius: 10px; padding: 15px; margin-bottom: 20px; display: grid; grid-template-columns: repeat(3, 1fr); gap: 10px; text-align: center;">
            <div class="fin-box" style="display: flex; flex-direction: column; border-right: 1px solid #4a5568;">
                <span class="fin-label" style="font-size: 10px; font-weight: bold; color: #a0aec0; text-transform: uppercase;">Total Gasto</span>
                <span id="finInvestidoScanner" class="fin-val" style="font-size: 14px; font-weight: bold; margin-top: 5px;">R$ 0,00</span>
            </div>
            <div class="fin-box" style="display: flex; flex-direction: column; border-right: 1px solid #4a5568;">
                <span class="fin-label" style="font-size: 10px; font-weight: bold; color: #a0aec0; text-transform: uppercase;">Retorno</span>
                <span id="finGanhoScanner" class="fin-val" style="font-size: 14px; font-weight: bold; margin-top: 5px; color: #48bb78">R$ 0,00</span>
            </div>
            <div class="fin-box" style="display: flex; flex-direction: column;">
                <span class="fin-label" style="font-size: 10px; font-weight: bold; color: #a0aec0; text-transform: uppercase;">Balan√ßo</span>
                <span id="finResultadoScanner" class="fin-val" style="font-size: 14px; font-weight: bold; margin-top: 5px;">R$ 0,00</span>
            </div>
        </div>

        <div class="dashboard-cobertura" style="background: #fff; border: 1px solid #ddd; padding: 12px; border-radius: 10px; margin-bottom: 20px;">
            <div class="stats-grid" style="display: grid; grid-template-columns: 1fr 1fr; text-align: center; font-size: 12px; font-weight: bold; color: #4a5568; gap: 10px;">
                <div style="background: #f7fafc; padding: 8px; border-radius: 6px;">Cobertos: <span id="valCobertosScanner" style="color: #9b2a92;">0</span></div>
                <div style="background: #f7fafc; padding: 8px; border-radius: 6px;">N√£o premiados: <span id="valLacunasScanner" style="color: #e74c3c;">0</span></div>
            </div>
            <div class="progress-container" style="background: #edf2f7; border-radius: 20px; height: 10px; margin: 12px 0; overflow: hidden; border: 1px solid #e2e8f0;">
                <div id="progressoBarraScanner" class="progress-bar" style="background: linear-gradient(90deg, #9b2a92, #209869); height: 100%; width: 0%; transition: 0.8s;"></div>
            </div>
            <center>
                <small id="pctTextoSanner" style="color: #718096; font-weight: bold; font-size: 12px;">Cobertura: 0%</small>
            </center>
        </div>

        <div class="config-grid" style="display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-bottom: 20px;">
            <div class="campo" style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 12px; font-weight: bold; color: #555;">Concurso Inicial:</label>
                <input type="number" id="concFocoScanner" placeholder="Ex: 3100" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; transition: 0.3s; width: 100%; box-sizing: border-box;" onfocus="this.style.borderColor='#9b2a92'">
                <label>
                    <span id="infoUltimoConcursoScanner" style="font-size: 10px; color: #209869; margin-bottom: 2px; display: block; line-height: 1.3;">Carregando √∫ltimo concurso...</span>
                </label>
            </div>
            <div class="campo" style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 12px; font-weight: bold; color: #555;">Concurso Final (opcional):</label>
                <input type="number" id="concFinalScanner" placeholder="Deixe em branco para ir at√© o √∫ltimo" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; transition: 0.3s; width: 100%; box-sizing: border-box;" onfocus="this.style.borderColor='#9b2a92'">
            </div>
            <div class="campo" style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 12px; font-weight: bold; color: #555;">Qtd de Jogos:</label>
                <input type="number" id="qtdJogosScanner" value="6" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; transition: 0.3s; width: 100%; box-sizing: border-box;" onfocus="this.style.borderColor='#9b2a92'" oninput="document.getElementById('qtdLucroPuroScanner').max = this.value">
            </div>
            <div class="campo" style="display: flex; flex-direction: column; gap: 5px;">
                <label style="font-size: 12px; font-weight: bold; color: #555;">Tentativas:</label>
                <input type="number" id="limiteTentativasScanner" value="10000" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; transition: 0.3s; width: 100%; box-sizing: border-box;" onfocus="this.style.borderColor='#9b2a92'">
            </div>
            <div class="campo" style="display: flex; flex-direction: column; gap: 5px; grid-column: span 2;">
                <label style="font-size: 12px; font-weight: bold; color: #555;">Foco Lucro:</label>
                <input type="number" id="qtdLucroPuroScanner" value="2" title="Jogos focados apenas no lucro" style="padding: 10px; border: 2px solid #ddd; border-radius: 8px; font-size: 14px; outline: none; transition: 0.3s; width: 100%; box-sizing: border-box;" onfocus="this.style.borderColor='#9b2a92'">
            </div>
        </div>

        <div class="controles" style="display: flex; flex-direction: column; gap: 10px; margin-bottom: 15px;">
            <button id="btnIniciarScanner" class="btn-start" onclick="iniciarScannerBusca()" style="padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 15px; background: #9b2a92; color: white; width: 100%;">üîç Iniciar Scanner</button>
            <button id="btnPararScanner" class="btn-stop" onclick="pararScannerTudo()" style="padding: 14px; border: none; border-radius: 8px; font-weight: bold; cursor: pointer; transition: 0.3s; font-size: 15px; background: #e74c3c; color: white; display: none; width: 100%;">üõë Parar</button>
        </div>

        <div id="statusRealScanner" style="background: #fffde7; border: 1px solid #fbc02d; padding: 12px; border-radius: 8px; margin-bottom: 15px; display: none; text-align: center;">
            <div id="statusMsgScanner" style="font-weight: bold; color: #555; margin-bottom: 5px; font-size: 13px;">Processando...</div>
            <span id="contadorTentativasScanner" class="contador-live" style="font-family: monospace; font-size: 18px; color: #9b2a92; font-weight: bold;">0</span>
        </div>

        <div id="resultadoFinalScanner" class="lista-jogos" style="margin-top: 15px; width: 100%;"></div>
        
        <!-- BOT√ÉO DE TRANSFERIR JOGOS -->
        <button class="btn-transferir" onclick="transferirJogosScanner()" style="background: linear-gradient(45deg, #209869, #1e824c); color: white; font-size: 14px; border: none; border-radius: 8px; cursor: pointer; font-weight: bold; padding: 14px; transition: 0.3s; width: 100%; margin: 15px 0;">
            üì§ Transferir Jogos para o Painel Principal
        </button>

	


	<!-- Modal de Confirma√ß√£o do Scanner -->
    <div id="modalScannerConfirm" class="modal-scanner-confirm" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10002; align-items: center; justify-content: center;">
        <div class="modal-scanner-confirm-content" style="background: white; padding: 25px; border-radius: 12px; max-width: 400px; width: 90%; box-shadow: 0 10px 30px rgba(0,0,0,0.3); position: relative;">
            <!-- Bot√£o de fechar no canto superior direito -->
            <button id="btnScannerClose" onclick="fecharModalScannerConfirm()" style="position: absolute; top: 10px; right: 10px; background: transparent; border: none; font-size: 20px; cursor: pointer; color: #666; padding: 0; width: 24px; height: 24px; display: flex; align-items: center; justify-content: center;">√ó</button>
            
            <div id="modalScannerMsg" style="font-weight: bold; color: #333; margin-bottom: 15px; padding-top: 10px;"></div>
            <div class="modal-scanner-buttons" style="display: flex; gap: 10px; margin-top: 20px; justify-content: center; flex-wrap: wrap;">
                <button id="btnScannerConfirm" class="btn-scanner-confirm" style="padding: 12px 20px; background: #4CAF50; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 14px; flex: 1; min-width: 140px;">Confirmar</button>
                <button id="btnScannerCancel" class="btn-scanner-cancel" style="padding: 12px 20px; background: #f44336; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 14px; flex: 1; min-width: 140px;">Cancelar</button>
                <button id="btnScannerCloseModal" class="btn-scanner-close" style="padding: 10px 15px; background: #666; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: bold; font-size: 13px; width: 100%; margin-top: 5px;">‚úï Fechar (N√£o transferir)</button>
            </div>
        </div>
    </div>


	
        <div class="aviso-legal" style="margin-top: 15px; font-size: 11px; color: #777; text-align: center; line-height: 1.4; padding: 10px; border-top: 1px dashed #ccc;">            
                    ‚ö†Ô∏è <b>Aviso:</b> Este site/aplicativo √© uma ferramenta independente para facilitar a gera√ß√£o de jogos (surpresinhas) de 15 n√∫meros da lotof√°cil. Os jogos gerados <b>n√£o garante ganhos reais ou pr√™mios nos concursos futuros</b>. N√£o nos responsabilizamos por eventuais inconsist√™ncias nos resultados apresentados. Este sistema n√£o possui v√≠nculo com a Caixa Econ√¥mica Federal.
                    <b>Sempre confira seu bilhete no site oficial das Lot√©rias Caixa.</b>
                    <p style="text-align: center;">üîû <b>APOSTAR √â PARA MAIORES DE 18 ANOS</b>
               <!-- (LINK Q MUDA PRA OUTRA PAGINA)  <a href="https://www.caixa.gov.br/jogo-responsavel/Paginas/default.aspx" target="_blank" style="color: #0e9f6e; text-decoration: none; font-weight: bold; font-size: 13px;">Acesse aqui o Guia do Jogo Respons√°vel</a> -->
         </div>
       `;


	document.addEventListener('keydown', function(e) {
   		 if (e.key === 'Escape') {
        	      const modal = document.getElementById('modalScannerConfirm');
      		      if (modal && modal.style.display === 'flex') {
      		      fecharModalScannerConfirm();
     		   }
  		  }
		});
    
    	// Carregar √∫ltimo concurso
   	 carregarUltimoConcursoScanner();
	}


        function fecharScanner() {
    	document.getElementById('modalScanner').style.display = 'none';
  	  if (isMobile) {
   	     document.body.style.overflow = 'auto';
    		}
  	  scannerJogosGerados = [];
    
   	 // Restaurar bot√µes do modal padr√£o
   	 restaurarBotoesModal();
		}


	function restaurarBotoesModal() {
  	  const modal = document.getElementById('modalCustom');
   	 const container = document.getElementById('modalContainerBotoes');
    
   	 if (container) {
     	   container.innerHTML = `
            <button id="btnSim" class="btn-modal btn-sim">Confirmar</button>
            <button id="btnNao" class="btn-modal btn-nao">Cancelar</button>
        `;
        
        // Restaurar eventos padr√£o se necess√°rio
        const btnSim = document.getElementById('btnSim');
        const btnNao = document.getElementById('btnNao');
        
        if (btnSim && btnNao) {
            btnSim.onclick = function() {
                modal.style.display = 'none';
            };
            btnNao.onclick = function() {
                modal.style.display = 'none';
            };
      	  }
   	 }
	}


        function toggleExplica√ß√£oScanner() {
            const content = document.getElementById('explica√ß√£oContentScanner');
            const seta = document.getElementById('setaComoScanner');
            if (content.style.maxHeight === "0px" || content.style.maxHeight === "") {
                content.style.maxHeight = "500px";
                seta.innerText = "‚ñ≤";
            } else {
                content.style.maxHeight = "0px";
                seta.innerText = "‚ñº";
            }
        }


        
        async function carregarUltimoConcursoScanner() {
            try {
                const resp = await fetch(`https://loteriascaixa-api.herokuapp.com/api/lotofacil/latest`);
                const dados = await resp.json();
                if (dados && dados.concurso) {
                    document.getElementById('infoUltimoConcursoScanner').innerText = `√öltimo concurso: ${dados.concurso} (${dados.data})`;
                    // Sugere um ponto de partida (10 concursos antes do √∫ltimo)
                    const concursoInicial = Math.max(1, dados.concurso - 10);
                    document.getElementById('concFocoScanner').value = concursoInicial;
                }
            } catch (e) {
                document.getElementById('infoUltimoConcursoScanner').innerText = "Erro ao carregar √∫ltimo";
            }
        }

        
        // Vari√°veis do scanner
        let scannerRodando = false;
        let scannerConcursosData = [];
        let scannerConcPremiadosGeral = new Set();
        let scannerJogosSelecionadosMasks = new Set();
        const PREMIOS_SCANNER = { 11: 7, 12: 14, 13: 35 };
        const CUSTO_JOGO_SCANNER = 3.50;
        
        function dezenasParaMaskScanner(dezenas) {
            let mask = 0;
            for (let n of dezenas) mask |= (1 << (n - 1));
            return mask;
        }
        
        function gerarDezenasScanner() {
            let n = new Set();
            while(n.size < 15) n.add(Math.floor(Math.random() * 25) + 1);
            let lista = [...n].sort((a,b) => a - b);
            return { lista: lista, mask: dezenasParaMaskScanner(lista) };
        }
        
        function conferirScanner(maskA, maskB) {
            let intersec = maskA & maskB;
            let acertos = 0;
            while (intersec) { intersec &= (intersec - 1); acertos++; }
            return acertos;
        }
        
        function atualizarDashboardScanner() {
            const totalConc = scannerConcursosData.length;
            const cobertos = scannerConcPremiadosGeral.size;
            const pct = totalConc > 0 ? (cobertos / totalConc) * 100 : 0;
            
            document.getElementById('valCobertosScanner').innerText = cobertos;
            document.getElementById('valLacunasScanner').innerText = totalConc - cobertos;
            document.getElementById('progressoBarraScanner').style.width = pct + "%";
            document.getElementById('pctTextoSanner').innerText = `Efici√™ncia de Cobertura: ${pct.toFixed(1)}%`;

            const qtdJogosGerados = document.querySelectorAll('#resultadoFinalScanner .jogo-item').length;
            const investidoTotal = (CUSTO_JOGO_SCANNER * totalConc) * qtdJogosGerados;
            
            let ganhoTotal = 0;
            document.querySelectorAll('.retorno-valor-scanner').forEach(el => {
                ganhoTotal += parseFloat(el.getAttribute('data-valor'));
            });

            const liquido = ganhoTotal - investidoTotal;

            document.getElementById('finInvestidoScanner').innerText = `R$ ${investidoTotal.toLocaleString('pt-br', {minimumFractionDigits: 2})}`;
            document.getElementById('finGanhoScanner').innerText = `R$ ${ganhoTotal.toLocaleString('pt-br', {minimumFractionDigits: 2})}`;
            document.getElementById('finResultadoScanner').innerText = `R$ ${liquido.toLocaleString('pt-br', {minimumFractionDigits: 2})}`;
            document.getElementById('finResultadoScanner').style.color = liquido >= 0 ? '#209869' : '#e74c3c';
        }
        
        function pararScannerTudo() { 
            scannerRodando = false; 
            document.getElementById('btnPararScanner').style.display = 'none';
            document.getElementById('btnIniciarScanner').disabled = false;
        }



function mostrarToastScanner(mensagem, tipo = 'info', posicao = 'top-right') {
    // Cria um toast tempor√°rio
    const toast = document.createElement('div');
    
    // Cores baseadas no tipo
    let corFundo, corBorda, icone;
    
    switch(tipo) {
        case 'sucesso':
            corFundo = '#4CAF50'; /* Verde */
            corBorda = '#388E3C';
            icone = '‚úÖ';
            break;
        case 'erro':
            corFundo = '#F44336'; /* Vermelho */
            corBorda = '#D32F2F';
            icone = '‚ùå';
            break;
        case 'alerta':
            corFundo = '#FF9800'; /* Laranja */
            corBorda = '#F57C00';
            icone = '‚ö†Ô∏è';
            break;
        case 'info':
        default: // info - AZUL CLARO
            corFundo = '#2196F3'; /* Azul claro */
            corBorda = '#1976D2';
            icone = '‚ÑπÔ∏è';
    }
    
    // Posi√ß√µes diferentes
    let posicaoCSS;
    switch(posicao) {
        case 'center':
            posicaoCSS = `
                top: 50%;
                left: 50%;
                transform: translate(-50%, -50%);
            `;
            break;
        case 'top-left':
            posicaoCSS = `
                top: 20px;
                left: 20px;
            `;
            break;
        case 'bottom-right':
            posicaoCSS = `
                bottom: 20px;
                right: 20px;
            `;
            break;
        case 'bottom-left':
            posicaoCSS = `
                bottom: 20px;
                left: 20px;
            `;
            break;
        case 'top-center':
            posicaoCSS = `
                top: 20px;
                left: 50%;
                transform: translateX(-50%);
            `;
            break;
        default: // top-right
            posicaoCSS = `
                top: 20px;
                right: 20px;
            `;
    }
    
    toast.style.cssText = `
        position: fixed;
        ${posicaoCSS}
        background: ${corFundo};
        color: white;
        padding: 15px 25px;
        border-radius: 12px; /* Bordas mais arredondadas */
        z-index: 10001;
        box-shadow: 0 8px 25px rgba(0,0,0,0.2); /* Sombra mais pronunciada */
        border-left: 6px solid ${corBorda}; /* Borda mais grossa */
        animation: slideInCenter 0.5s ease-out;
        font-weight: bold;
        opacity: 0.95;
        display: flex;
        align-items: center;
        gap: 10px;
        min-width: 300px;
        text-align: center;
        font-size: 14px;
        backdrop-filter: blur(5px); /* Efeito de vidro fosco */
    `;
    
    // Adiciona anima√ß√£o para toast no centro
    const style = document.createElement('style');
    style.textContent = `
        @keyframes slideInCenter {
            from {
                opacity: 0;
                transform: ${posicao === 'center' ? 'translate(-50%, -60%)' : 
                            posicao === 'top-center' ? 'translateX(-50%) translateY(-20px)' : 
                            'translateX(20px)'};
            }
            to {
                opacity: 0.95;
                transform: ${posicao === 'center' ? 'translate(-50%, -50%)' : 
                            posicao === 'top-center' ? 'translateX(-50%) translateY(0)' : 
                            'translateX(0)'};
            }
        }
        
        @keyframes fadeOut {
            from { opacity: 0.95; }
            to { opacity: 0; }
        }
    `;
    document.head.appendChild(style);
    
    toast.innerHTML = `<div style="font-size: 18px;">${icone}</div><div>${mensagem}</div>`;
    document.body.appendChild(toast);
    
    setTimeout(() => { 
        toast.style.animation = 'fadeOut 0.5s ease-out forwards'; 
        setTimeout(() => toast.remove(), 500); 
    }, 3000);
}

// Atualize as chamadas da fun√ß√£o para usar a posi√ß√£o central para mensagens de valida√ß√£o:

async function iniciarScannerBusca() {
    // Captura dos valores
    const valConc = document.getElementById('concFocoScanner').value;
    const valFinal = document.getElementById('concFinalScanner').value;
    const valQtd = document.getElementById('qtdJogosScanner').value;
    const valTentativas = document.getElementById('limiteTentativasScanner').value;
    const valLucro = document.getElementById('qtdLucroPuroScanner').value;

    // Valida√ß√£o de campos vazios ou menores que 1
    if (!valConc || parseInt(valConc) < 1) {
        mostrarToastScanner("‚ö†Ô∏è Insira um valor v√°lido para: Concurso Inicial", 'info', 'center');
        return;
    }
    if (!valQtd || parseInt(valQtd) < 1) {
        mostrarToastScanner("‚ö†Ô∏è Insira um valor v√°lido para: Qtd Total de Jogos", 'info', 'center');
        return;
    }
    if (!valTentativas || parseInt(valTentativas) < 1) {
        mostrarToastScanner("‚ö†Ô∏è Insira um valor v√°lido para: Tentativas Base", 'info', 'center');
        return;
    }
    if (!valLucro || parseInt(valLucro) < 1) {
        mostrarToastScanner("‚ö†Ô∏è Insira um valor v√°lido para: Jogos Foco Lucro Puro", 'info', 'center');
        return;
    }

    const inicioNum = parseInt(valConc);
    let fimNum = null;
    
    // Se houver valor no concurso final, validar
    if (valFinal && valFinal.trim() !== '') {
        fimNum = parseInt(valFinal);
        if (isNaN(fimNum) || fimNum < 1) {
            mostrarToastScanner("‚ö†Ô∏è Insira um valor v√°lido para: Concurso Final", 'info', 'center');
            return;
        }
        if (fimNum < inicioNum) {
            mostrarToastScanner("‚ö†Ô∏è Concurso final deve ser maior ou igual ao inicial", 'alerta', 'center');
            return;
        }
    }
    
    // Primeiro, verificar qual √© o √∫ltimo concurso dispon√≠vel
    try {
        document.getElementById('statusMsgScanner').innerText = "Verificando √∫ltimo concurso...";
        document.getElementById('statusRealScanner').style.display = 'block';
        
        const resp = await fetch(`https://loteriascaixa-api.herokuapp.com/api/lotofacil/latest`);
        const ultimoConcurso = await resp.json();
        
        if (inicioNum > ultimoConcurso.concurso) {
            mostrarToastScanner(`‚ö†Ô∏è CONCURSO N√ÉO ENCONTRADO OU N√ÉO SORTEADO.<br>O √∫ltimo concurso dispon√≠vel √© o ${ultimoConcurso.concurso}.`, 'erro', 'center');
            document.getElementById('statusRealScanner').style.display = 'none';
            return;
        }
        
        // Se n√£o foi definido concurso final, usar o √∫ltimo
        if (!fimNum) {
            fimNum = ultimoConcurso.concurso;
        } else if (fimNum > ultimoConcurso.concurso) {
            mostrarToastScanner(`‚ö†Ô∏è Concurso final (${fimNum}) maior que o √∫ltimo dispon√≠vel (${ultimoConcurso.concurso}). Usando √∫ltimo concurso.`, 'alerta', 'center');
            fimNum = ultimoConcurso.concurso;
            document.getElementById('concFinalScanner').value = fimNum;
        }
        
        // Atualizar o campo com o valor correto se estiver acima do limite
        if (inicioNum < 1) {
            document.getElementById('concFocoScanner').value = 1;
        } else if (inicioNum > ultimoConcurso.concurso) {
            document.getElementById('concFocoScanner').value = ultimoConcurso.concurso;
        }
        
    } catch (e) {
        mostrarToastScanner("Erro ao verificar √∫ltimo concurso.<br>Verifique sua conex√£o.", 'erro', 'center');
        document.getElementById('statusRealScanner').style.display = 'none';
        return;
    }

    const limiteBase = parseInt(valTentativas);
    const totalJogosDesejados = parseInt(valQtd);
    const corteLucroPuro = parseInt(valLucro);

    scannerRodando = true;
    scannerConcPremiadosGeral.clear();
    scannerJogosSelecionadosMasks.clear();
    scannerJogosGerados = []; // Limpa jogos anteriores
    document.getElementById('btnIniciarScanner').disabled = true;
    document.getElementById('btnPararScanner').style.display = 'block';
    document.getElementById('statusRealScanner').style.display = 'block';
    document.getElementById('resultadoFinalScanner').innerHTML = "";

    try {
        document.getElementById('statusMsgScanner').innerText = "Baixando resultados da API...";
        const resp = await fetch(`https://loteriascaixa-api.herokuapp.com/api/lotofacil/`);
        const dados = await resp.json();
        
        // Filtrar apenas concursos v√°lidos (que existem e est√£o entre inicioNum e fimNum)
        scannerConcursosData = dados.filter(c => c.concurso >= inicioNum && c.concurso <= fimNum).map(c => ({
            id: c.concurso, 
            mask: dezenasParaMaskScanner(c.dezenas.map(Number))
        }));
        
        // Verificar se h√° dados para os concursos solicitados
        if (scannerConcursosData.length === 0) {
            mostrarToastScanner(`‚ö†Ô∏è Nenhum concurso encontrado de ${inicioNum} a ${fimNum}.`, 'erro');
            document.getElementById('btnIniciarScanner').disabled = false;
            document.getElementById('btnPararScanner').style.display = 'none';
            document.getElementById('statusRealScanner').style.display = 'none';
            return;
        }

        for (let j = 1; j <= totalJogosDesejados; j++) {
            if (!scannerRodando) break;

            let melhorDoCiclo = { score: -1, jogo: [], mask: 0, s11:0, s12:0, s13:0, lucro: 0, ids: [], tentativasReais: 0 };
            let modoHibrido = j > corteLucroPuro;
            let limiteTentativasCiclo = modoHibrido ? (limiteBase * 2) : limiteBase;

            for (let t = 1; t <= limiteTentativasCiclo; t++) {
                if (!scannerRodando) break;

                let candidato = gerarDezenasScanner();
                if (scannerJogosSelecionadosMasks.has(candidato.mask)) continue;

                let stats = { 11: 0, 12: 0, 13: 0, lucro: 0, ids: [] };

                scannerConcursosData.forEach(conc => {
                    let pts = conferirScanner(candidato.mask, conc.mask);
                    if (pts >= 11 && pts <= 13) {
                        stats[pts]++;
                        stats.lucro += PREMIOS_SCANNER[pts];
                        stats.ids.push(conc.id);
                    }
                });

                let score = stats.lucro; 
                let novosAtendidos = 0;

                if (modoHibrido) {
                    novosAtendidos = stats.ids.filter(id => !scannerConcPremiadosGeral.has(id)).length;
                    score += (novosAtendidos * 85); 
                }

                if (score > melhorDoCiclo.score) {
                    melhorDoCiclo = {
                        score: score, 
                        jogo: candidato.lista, 
                        mask: candidato.mask, 
                        lucro: stats.lucro,
                        s11: stats[11], 
                        s12: stats[12], 
                        s13: stats[13],
                        novos: novosAtendidos, 
                        ids: stats.ids, 
                        tentativasReais: t, 
                        hibrido: modoHibrido
                    };
                }

                if (t % 500 === 0) {
                    document.getElementById('contadorTentativasScanner').innerText = `${t} / ${limiteTentativasCiclo}`;
                    document.getElementById('statusMsgScanner').innerText = `Escaneando Jogo ${j}...`;
                    await new Promise(r => setTimeout(r, 0));
                }
            }

            if (melhorDoCiclo.score > -1) {
                melhorDoCiclo.ids.forEach(id => scannerConcPremiadosGeral.add(id));
                scannerJogosSelecionadosMasks.add(melhorDoCiclo.mask);
                // Armazena o jogo gerado
                scannerJogosGerados.push(melhorDoCiclo.jogo);
                exibirJogoScanner(j, melhorDoCiclo);
                atualizarDashboardScanner();
            }
        }
    } catch (e) {
        mostrarToastScanner("Erro ao carregar dados da API.", 'erro');
        console.error(e);
    } finally {
        scannerRodando = false;
        document.getElementById('btnIniciarScanner').disabled = false;
        document.getElementById('btnPararScanner').style.display = 'none';
        document.getElementById('statusRealScanner').style.display = 'none';
        document.getElementById('statusMsgScanner').innerText = scannerJogosGerados.length > 0 ? 
            `Processamento conclu√≠do! ${scannerJogosGerados.length} jogos gerados.` : 
            "Processamento conclu√≠do.";
    }
}


        function exibirJogoScanner(num, d) {
            const container = document.getElementById('resultadoFinalScanner');
            const item = document.createElement('div');
            item.className = 'jogo-item';
            item.style.cssText = `
                background: white;
                border: 1px solid #eee;
                border-radius: 12px;
                padding: 18px;
                margin-bottom: 15px;
                position: relative;
                border-left: 6px solid ${d.hibrido ? '#f39c12' : '#9b2a92'};
                box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            `;
            
            item.innerHTML = `
                <div style="position: absolute; top: -10px; left: 15px; background: ${d.hibrido ? '#f39c12' : '#9b2a92'}; color: white; padding: 3px 12px; border-radius: 20px; font-size: 10px; font-weight: bold;">
                    ${d.hibrido ? 'SCAN H√çBRIDO (LACUNA+LUCRO)' : 'BUSCA: FOCO LUCRO PURO'} - JOGO ${num}
                </div>
                <div class="dezenas" style="display: flex; flex-wrap: wrap; gap: 6px; margin: 12px 0;">
                    ${d.jogo.map(n => `
                        <div class="bola" style="width: 32px; height: 32px; background: #fff; border-radius: 50%; display: flex; align-items: center; justify-content: center; font-size: 14px; font-weight: bold; color: #9b2a92; border: 2px solid #9b2a92;">
                            ${n.toString().padStart(2, '0')}
                        </div>
                    `).join('')}
                </div>
                <div class="resumo-financeiro" style="background: #f0fff4; padding: 12px; border-radius: 8px; display: grid; grid-template-columns: 1fr 1fr; gap: 8px; font-size: 12px; border: 1px solid #c6f6d5;">
                    <div class="lucro-destaque" style="grid-column: span 2; font-size: 15px; color: #209869; font-weight: bold; text-align: center; border-bottom: 1px solid #c6f6d5; padding-bottom: 5px; margin-bottom: 5px;">
                        RETORNO HIST√ìRICO: <span class="retorno-valor-scanner" data-valor="${d.lucro}">R$ ${d.lucro.toFixed(2)}</span>
                    </div>
                    <span>üéØ 13 Pontos: <b>${d.s13}x</b></span>
                    <span>ü•à 12 Pontos: <b>${d.s12}x</b></span>
                    <span>ü•â 11 Pontos: <b>${d.s11}x</b></span>
                    <span>‚ú® Novas Lacunas: <b>+${d.novos}</b></span>
                    <span style="grid-column: span 2; font-size: 9px; color: #999; text-align: center; margin-top: 5px;">Analisado em ${d.tentativasReais} tentativas</span>
                </div>
            `;
            container.appendChild(item);
        }
        
       
	function transferirJogosScanner() {
  	  if (scannerJogosGerados.length === 0) {
 	       mostrarToastScanner("N√£o h√° jogos gerados para transferir.", 'erro', 'center');
  	      return;
  	  }
    
	    // Verificar se j√° existem jogos no painel principal
   	 const jogosExistentes = dados['lotofacil'].meusJogos.length;
    
  	  if (jogosExistentes > 0) {
        // Mostrar modal de confirma√ß√£o DENTRO do scanner
        const modal = document.getElementById('modalScannerConfirm');
        const msgEl = document.getElementById('modalScannerMsg');
        const btnConfirm = document.getElementById('btnScannerConfirm');
        const btnCancel = document.getElementById('btnScannerCancel');
        const btnCloseModal = document.getElementById('btnScannerCloseModal');
        
        msgEl.innerHTML = `
            <div style="text-align: left;">
                <p style="color: #f39c12; font-size: 16px; margin-bottom: 10px;"><strong>‚ö†Ô∏è Aten√ß√£o!</strong></p>
                <p>Voc√™ tem <strong style="color: #9b2a92;">${jogosExistentes} jogo(s)</strong> salvos no painel principal.</p>
                <p>Deseja <strong style="color: #d93025;">APAGAR todos os jogos atuais</strong> e substituir pelos <strong style="color: #209869;">${scannerJogosGerados.length} jogo(s)</strong> gerados no scanner?</p>
                <div style="background: #fff3cd; border: 1px solid #ffeaa7; padding: 10px; border-radius: 5px; margin-top: 15px; font-size: 12px;">
                    <strong>üìù Observa√ß√£o:</strong> Esta a√ß√£o n√£o pode ser desfeita. Os jogos atuais ser√£o perdidos.
                </div>
            </div>
        `;
        
        // Configurar bot√µes
        btnConfirm.innerText = 'üîÑ Substituir (Apagar tudo)';
        btnConfirm.style.background = '#d93025';
        
        btnCancel.innerText = '‚ûï Adicionar (Manter atual)';
        btnCancel.style.background = '#2196F3';
        
        btnCloseModal.innerText = '‚úï Fechar (N√£o transferir)';
        btnCloseModal.style.background = '#666';
        
        // Mostrar modal
        modal.style.display = 'flex';
        
        // Configurar eventos
        btnConfirm.onclick = function() {
            modal.style.display = 'none';
            executarTransferenciaScanner(true); // true = apagar jogos existentes
        };
        
        btnCancel.onclick = function() {
            modal.style.display = 'none';
            // Pergunta se quer adicionar sem apagar
            msgEl.innerHTML = `
                <div style="text-align: left;">
                    <p style="color: #2196F3; font-size: 16px; margin-bottom: 10px;"><strong>‚ûï Adicionar Jogos</strong></p>
                    <p>Deseja <strong>adicionar os ${scannerJogosGerados.length} jogo(s)</strong> do scanner <strong>sem apagar</strong> os jogos existentes?</p>
                    <p>Total final: <strong style="color: #209869;">${jogosExistentes + scannerJogosGerados.length} jogos</strong></p>
                    <div style="background: #d4edda; border: 1px solid #c3e6cb; padding: 10px; border-radius: 5px; margin-top: 15px; font-size: 12px;">
                        <strong>üí° Op√ß√µes:</strong><br>
                        1. <strong>Substituir:</strong> Apaga tudo e adiciona apenas os novos<br>
                        2. <strong>Adicionar:</strong> Mant√©m os atuais e adiciona os novos<br>
                        3. <strong>Cancelar:</strong> N√£o transferir nenhum jogo
                    </div>
                </div>
            `;
            
            btnConfirm.innerText = '‚úÖ Adicionar (Manter tudo)';
            btnConfirm.style.background = '#4CAF50';
            
            btnCancel.innerText = 'üîÑ Voltar √† substitui√ß√£o';
            btnCancel.style.background = '#f39c12';
            
            btnCloseModal.innerText = '‚úï Cancelar (N√£o transferir)';
            btnCloseModal.style.background = '#666';
            
            btnConfirm.onclick = function() {
                modal.style.display = 'none';
                executarTransferenciaScanner(false); // false = n√£o apagar jogos existentes
            };
            
            btnCancel.onclick = function() {
                modal.style.display = 'none';
                // Reabre o primeiro modal
                setTimeout(() => transferirJogosScanner(), 50);
            };
            
            btnCloseModal.onclick = function() {
                modal.style.display = 'none';
                mostrarToastScanner("‚ùå Transfer√™ncia cancelada. Nenhum jogo foi transferido.", 'info', 'center');
            };
            
            modal.style.display = 'flex';
        };
        
        // Bot√£o de fechar (n√£o transferir)
        btnCloseModal.onclick = function() {
            modal.style.display = 'none';
            mostrarToastScanner("‚ùå Transfer√™ncia cancelada. Nenhum jogo foi transferido.", 'info', 'center');
        };
        
    } else {
        // N√£o h√° jogos existentes, transferir diretamente
        executarTransferenciaScanner(false);
    }
}

// Fun√ß√£o para fechar o modal de confirma√ß√£o (bot√£o X no canto)
function fecharModalScannerConfirm() {
    const modal = document.getElementById('modalScannerConfirm');
    if (modal) {
        modal.style.display = 'none';
        mostrarToastScanner("‚ùå Transfer√™ncia cancelada. Nenhum jogo foi transferido.", 'info', 'center');
    }
}


function executarTransferenciaScanner(apagarExistentes) {
    if (apagarExistentes) {
        // Limpa todos os jogos existentes
        dados['lotofacil'].meusJogos = [];
        financeiroH['lotofacil'] = { investido: 0, ganho: 0, concursos_vistos: [] };
        contagemElite['lotofacil'] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
        
        mostrarToastScanner(`üóëÔ∏è ${scannerJogosGerados.length} jogos transferidos (substitu√≠dos)`, 'info', 'center');
    } else {
        const jogosAntes = dados['lotofacil'].meusJogos.length;
        mostrarToastScanner(`‚ûï ${scannerJogosGerados.length} jogos adicionados (total: ${jogosAntes + scannerJogosGerados.length})`, 'sucesso', 'center');
    }
    
    // Adiciona cada jogo do scanner ao painel principal
    scannerJogosGerados.forEach(jogo => {
        dados['lotofacil'].meusJogos.push({
            numeros: jogo,
            vitorias: 0,
            vitorias12: 0,
            vitorias13: 0,
            ganhoAcumulado: 0,
            concursosVistos: []
        });
    });
    
    salvarNoLocalStorage('lotofacil');
    renderizar('lotofacil');
    
    // Muda para a aba da Lotof√°cil se n√£o estiver nela
    if (!document.getElementById('cont-lotofacil').classList.contains('active')) {
        switchTab('lotofacil');
    }
    
    // Fecha o scanner ap√≥s 2 segundos
    setTimeout(() => {
        fecharScanner();
    }, 500);
}


function executarTransferencia(apagarExistentes) {
    if (apagarExistentes) {
        // Limpa todos os jogos existentes
        dados['lotofacil'].meusJogos = [];
        financeiroH['lotofacil'] = { investido: 0, ganho: 0, concursos_vistos: [] };
        contagemElite['lotofacil'] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
        
        mostrarToastScanner(`üóëÔ∏è ${scannerJogosGerados.length} jogos transferidos (substitu√≠dos)`, 'info', 'center');
    } else {
        const jogosAntes = dados['lotofacil'].meusJogos.length;
        mostrarToastScanner(`‚ûï ${scannerJogosGerados.length} jogos adicionados (total: ${jogosAntes + scannerJogosGerados.length})`, 'sucesso', 'center');
    }
    
    // Adiciona cada jogo do scanner ao painel principal
    scannerJogosGerados.forEach(jogo => {
        dados['lotofacil'].meusJogos.push({
            numeros: jogo,
            vitorias: 0,
            vitorias12: 0,
            vitorias13: 0,
            ganhoAcumulado: 0,
            concursosVistos: []
        });
    });


    //=================================================
    salvarNoLocalStorage('lotofacil');
    renderizar('lotofacil');
    
    // Muda para a aba da Lotof√°cil se n√£o estiver nela
    if (!document.getElementById('cont-lotofacil').classList.contains('active')) {
        switchTab('lotofacil');
    }
    
    // Fecha o scanner ap√≥s 2 segundos
    setTimeout(() => {
        fecharScanner();
    }, 2000);
}


//======================================================
//MOSTRAR BALAO DO CONTATO==============================

let tooltipTimeout;

function showTooltip() {
    const tooltip = document.getElementById('meuBalao');
    
    // Cancela o timeout anterior se existir
    if (tooltipTimeout) {
        clearTimeout(tooltipTimeout);
    }
    
    // Mostra o tooltip
    tooltip.classList.add('show');
    
    // Configura para desaparecer ap√≥s 3 segundos (3000ms)
    tooltipTimeout = setTimeout(() => {
        tooltip.classList.remove('show');
    }, 3000); // 3000ms = 3 segundos
    


    // Adiciona funcionalidade de copiar email
    tooltip.onclick = function(e) {
        e.stopPropagation();
        copyToClipboard('aironagm@gmail.com');
        
        // Muda temporariamente o texto para confirmar c√≥pia
        const originalText = tooltip.innerHTML;
        tooltip.innerHTML = '‚úÖ Email copiado!';
        tooltip.style.background = '#27ae60';
       
        // Reseta ap√≥s 1.5 segundos
        setTimeout(() => {
            tooltip.innerHTML = originalText;
            tooltip.style.background = '#2c3e50';
        }, 1500);
    };
}

// Fun√ß√£o para copiar para a √°rea de transfer√™ncia
function copyToClipboard(text) {
    navigator.clipboard.writeText(text).then(() => {
        console.log('Email copiado: ' + text);
    }).catch(err => {
        console.error('Erro ao copiar: ', err);
        // Fallback para navegadores antigos
        const textArea = document.createElement('textarea');
        textArea.value = text;
        document.body.appendChild(textArea);
        textArea.select();
        document.execCommand('copy');
        document.body.removeChild(textArea);
    });
}

// Fecha o tooltip se clicar fora dele
document.addEventListener('click', function(event) {
    const tooltip = document.getElementById('meuBalao');
    if (!tooltip.contains(event.target) && 
        !event.target.matches('[onclick*="showTooltip"]')) {
        tooltip.classList.remove('show');
        if (tooltipTimeout) {
            clearTimeout(tooltipTimeout);
        }
    }
});


        // =============================================
        // INICIALIZA√á√ÉO DO SISTEMA
        // =============================================

        window.onload = () => {
            zerarFinanceiro('lotofacil');
            zerarFinanceiro('megasena');
            contagemElite['lotofacil'] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
            contagemElite['megasena'] = { c14: 0, c15: 0, lista14: [], lista15: [], concursos_processados: [] };
            limparEstatisticasJogos('lotofacil');
            limparEstatisticasJogos('megasena');
            buscar('lotofacil', 'latest');
            buscar('megasena', 'latest');
            unificarNovosBotoes();
        };


    </script>
</body>
</html>
